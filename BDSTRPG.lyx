#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\begin_preamble
\date{}

% cleveref allows \ref{thm:asdf} instead of Theorem~\ref{thm:asdf}
\usepackage[nameinlink,capitalise,noabbrev]{cleveref}
\AtBeginDocument{\renewcommand{\ref}[1]{\cref{#1}}}

\usepackage[parfill]{parskip}
\setlength{\parskip}{\bigskipamount}

%have space before theorems
\begingroup
    \makeatletter
    \@for\theoremstyle:=definition,remark,plain\do{%
        \expandafter\g@addto@macro\csname th@\theoremstyle\endcsname{%
            \addtolength\thm@preskip\parskip
            }%
        }
\endgroup

% LyX won't let me include cleveref before theorem declarations so I need to redefine everything as a hack
\theoremstyle{plain}
\newtheorem{mythm}{\protect\theoremname}
\renewenvironment{thm}{\begin{mythm}}{\end{mythm}}
\crefname{mythm}{Theorem}{Theorems}
\theoremstyle{definition}
\newtheorem{mydefn}[mythm]{\protect\definitionname}
\renewenvironment{defn}{\begin{mydefn}}{\end{mydefn}}
\theoremstyle{definition}
\newtheorem{myexample}[mythm]{\protect\examplename}
\renewenvironment{example}{\begin{myexample}}{\end{myexample}}
\theoremstyle{plain}
\newtheorem{myprop}[mythm]{\protect\propositionname}
\renewenvironment{prop}{\begin{myprop}}{\end{myprop}}
\theoremstyle{plain}
\newtheorem{mycor}[mythm]{\protect\corollaryname}
\renewenvironment{cor}{\begin{mycor}}{\end{mycor}}
\theoremstyle{plain}
\newtheorem{mylem}[mythm]{\protect\lemmaname}
\renewenvironment{lem}{\begin{mylem}}{\end{mylem}}
\crefname{mylem}{Lemma}{Lemmas}
\theoremstyle{plain}
\newtheorem{myconjecture}[mythm]{\protect\conjecturename}
\renewenvironment{conjecture}{\begin{myconjecture}}{\end{myconjecture}}
\theoremstyle{remark}
\newtheorem{myrem}[mythm]{\protect\remarkname}
\renewenvironment{rem}{\begin{myrem}}{\end{myrem}}
\theoremstyle{remark}
\newtheorem{myclaim}[mythm]{\protect\claimname}
\renewenvironment{claim}{\begin{myclaim}}{\end{myclaim}}

% equation cref format
\crefformat{equation}{#2(#1)#3}

% \left(\right) should behave the same as ()
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}
\usepackage{verbatim}

%make sure tildes in url are vertically centered
\makeatletter
\renewcommand*{\UrlTildeSpecial}{%
  \do\~{%
    \mbox{%
      \fontfamily{ptm}\selectfont
      \textasciitilde
    }%
  }%  
}%    
\let\Url@force@Tilde\UrlTildeSpecial
\makeatother

%graph drawing
\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows.meta}
\tikzexternalize
\tikzstyle{vertex}=[circle,draw=black,fill=black,inner sep=0,minimum size=0.2cm,text=white,font=\footnotesize]
\tikzset{arc/.style={
        decoration={markings,
            mark= at position 0.5 with {\arrow{Latex[length=2mm,width=2mm]}} ,
        },
        postaction={decorate}
    }
}
\tikzset{every loop/.style={min distance=50,in=50,out=130,looseness=7}}

%caption labels
\usepackage[labelfont=bf,labelsep=period]{caption}

\usepackage{enumitem}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman cmr
\font_sans cmss
\font_typewriter cmtt
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing other 0.96
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\branch Folded
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip bigskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Bounded-degree spanning trees in randomly perturbed graphs
\end_layout

\begin_layout Author
Michael Krivelevich, Matthew Kwan, Benny Sudakov
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\RR}{\mathbb{R}}
{\boldsymbol{\mathbb{R}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\QQ}{\mathbb{Q}}
{\boldsymbol{\mathbb{Q}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\HH}{\mathbb{H}}
{\boldsymbol{\mathbb{H}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\E}{\mathbb{E}}
{\boldsymbol{\mathbb{E}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Var}{\operatorname{Var}}
{\mathbf{Var}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\CC}{\mathbb{C}}
{\boldsymbol{\mathbb{C}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\NN}{\mathbb{N}}
{\boldsymbol{\mathbb{N}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ZZ}{\mathbb{Z}}
{\boldsymbol{\mathbb{Z}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\GG}{\mathbb{G}}
{\boldsymbol{\mathbb{G}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\BB}{\mathbb{B}}
{\boldsymbol{\mathbb{B}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\DD}{\mathbb{D}}
{\boldsymbol{\mathbb{D}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\cL}{\mathcal{L}}
{\boldsymbol{\mathcal{L}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\supp}{\operatorname{supp}}
{\mathbf{supp}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\one}{\boldsymbol{1}}
{\boldsymbol{\boldsymbol{1}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\range}[1]{\left[#1\right]}
{\boldsymbol{\left[#1\right]}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\d}{\operatorname{d}}
{\mathbf{d}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\falling}[2]{\left(#1\right)_{#2}}
{\boldsymbol{\left(#1\right)_{#2}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\f}{\mathbf{f}}
{\boldsymbol{\mathbf{f}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\im}{\operatorname{im}}
{\mathbf{im}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\sp}{\operatorname{span}}
{\mathbf{span}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\sign}{\operatorname{sign}}
{\mathbf{sign}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\mod}{\operatorname{mod}}
{\mathbf{mod}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\id}{\operatorname{id}}
{\mathbf{id}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\disc}{\operatorname{disc}}
{\mathbf{disc}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\lindisc}{\operatorname{lindisc}}
{\mathbf{lindisc}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\mathbf{tr}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\adj}{\operatorname{adj}}
{\mathbf{adj}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Unif}{\operatorname{Unif}}
{\mathbf{Unif}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Po}{\operatorname{Po}}
{\mathbf{Po}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Bin}{\operatorname{Bin}}
{\mathbf{Bin}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Ber}{\operatorname{Ber}}
{\mathbf{Ber}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Geom}{\operatorname{Geom}}
{\mathbf{Geom}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Hom}{\operatorname{Hom}}
{\mathbf{Hom}\,}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\floor}[1]{\left\lfloor #1\right\rfloor }
{\boldsymbol{\left\lfloor #1\right\rfloor }}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ceil}[1]{\left\lceil #1\right\rceil }
{\boldsymbol{\left\lceil #1\right\rceil }}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\flip}[1]{\overline{#1}}
{\boldsymbol{\overline{#1}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\a}{\alpha}
{\boldsymbol{\alpha}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\c}{c}
{\boldsymbol{c}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\D}{\Delta}
{\boldsymbol{\Delta}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\G}{G}
{\boldsymbol{G}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\F}{F}
{\boldsymbol{F}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\T}{T}
{\boldsymbol{T}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\R}{R}
{\boldsymbol{R}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\B}[1]{\Gamma_{A,B}\left(#1\right)}
{\boldsymbol{\Gamma_{A,B}\left(#1\right)}}
\end_inset


\end_layout

\begin_layout Abstract
We show that for any bounded-degree spanning tree 
\begin_inset Formula $T$
\end_inset

 and any fixed dense graph 
\begin_inset Formula $G$
\end_inset

, a modest random perturbation of 
\begin_inset Formula $G$
\end_inset

 will typically contain a copy of 
\begin_inset Formula $T$
\end_inset

.
 This combines the viewpoints of the well-studied problems of embedding
 trees into fixed dense graphs and into random graphs, and extends a sizeable
 body of existing research on randomly perturbed graphs.
 Specifically, we show that there is 
\begin_inset Formula $\c=\c\left(\a,\D\right)$
\end_inset

 such that if 
\begin_inset Formula $\G$
\end_inset

 is an 
\begin_inset Formula $n$
\end_inset

-vertex graph with minimum degree at least 
\begin_inset Formula $\a n$
\end_inset

, and 
\begin_inset Formula $\T$
\end_inset

 is an 
\begin_inset Formula $n$
\end_inset

-vertex tree with maximum degree at most 
\begin_inset Formula $\D$
\end_inset

, then if we add 
\begin_inset Formula $\c n$
\end_inset

 uniformly random edges to 
\begin_inset Formula $\G$
\end_inset

, the resulting graph will contain 
\begin_inset Formula $\T$
\end_inset

 asymptotically almost surely (as 
\begin_inset Formula $n\to\infty$
\end_inset

).
 Our proof depends on a lemma concerning the decomposition of a dense graph
 into super-regular pairs of uneven sizes, which may be of independent interest.
\end_layout

\begin_layout Standard
\begin_inset Branch Folded
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{comment}
\end_layout

\end_inset


\end_layout

\begin_layout Theorem
t
\end_layout

\begin_layout Corollary
c
\end_layout

\begin_layout Lemma
l
\end_layout

\begin_layout Proposition
p
\end_layout

\begin_layout Conjecture
c
\end_layout

\begin_layout Definition
d
\end_layout

\begin_layout Example
e
\end_layout

\begin_layout Remark
r
\end_layout

\begin_layout Claim
c
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{comment}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
A classical theorem of Dirac 
\begin_inset CommandInset citation
LatexCommand cite
key "Dir52"

\end_inset

 states that any 
\begin_inset Formula $n$
\end_inset

-vertex graph (
\begin_inset Formula $n\ge3$
\end_inset

) with minimum degree at least 
\begin_inset Formula $n/2$
\end_inset

 has a Hamilton cycle: a cycle that passes through all the vertices of the
 graph.
 More recently, there have been many results showing that this kind of minimum
 degree condition is sufficient to guarantee the existence of different
 kinds of spanning graphs.
 For example, 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1$'$"
key "KSS95"

\end_inset

 says that for any 
\begin_inset Formula $\Delta$
\end_inset

 and 
\begin_inset Formula $\gamma>0$
\end_inset

, any 
\begin_inset Formula $n$
\end_inset

-vertex graph (
\begin_inset Formula $n$
\end_inset

 sufficiently large) with minimum degree 
\begin_inset Formula $\left(1/2+\gamma\right)n$
\end_inset

 contains every spanning tree which has maximum degree at most 
\begin_inset Formula $\Delta$
\end_inset

.
 (This has also been generalized further in two directions: to allow 
\begin_inset Formula $\Delta$
\end_inset

 to grow with 
\begin_inset Formula $n$
\end_inset

 and to allow for much more general spanning subgraphs than spanning trees;
 see 
\begin_inset CommandInset citation
LatexCommand cite
key "KSS01,BST09"

\end_inset

).
\end_layout

\begin_layout Standard
The constant 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $1/2$
\end_inset


\begin_inset Quotes erd
\end_inset

 in the above Dirac-type theorems is tight: in order to guarantee the existence
 of these spanning subgraphs we require very strong density conditions.
 But the situation is very different for a 
\begin_inset Quotes eld
\end_inset

typical
\begin_inset Quotes erd
\end_inset

 large graph.
 If we fix an arbitrarily small 
\begin_inset Formula $\alpha>0$
\end_inset

 and select a graph uniformly at random among the (labelled) graphs with
 
\begin_inset Formula $n$
\end_inset

 vertices and 
\begin_inset Formula $\alpha{n \choose 2}$
\end_inset

 edges, then the degrees will probably each be about 
\begin_inset Formula $\alpha n$
\end_inset

.
 Such a random graph is Hamiltonian with probability 
\begin_inset Formula $1-o\left(1\right)$
\end_inset

 (we say it is Hamiltonian 
\emph on
asymptotically almost surely
\emph default
, or 
\emph on
a.a.s.
\emph default
).
 This follows from a stronger result 
\begin_inset CommandInset citation
LatexCommand cite
key "Pos76"

\end_inset

 that gives a 
\emph on
threshold
\emph default
 for Hamiltonicity: a random 
\begin_inset Formula $n$
\end_inset

-vertex, 
\begin_inset Formula $m$
\end_inset

-edge graph is Hamiltonian a.a.s.
 if 
\begin_inset Formula $m\gg n\log n$
\end_inset

, and fails to be Hamiltonian a.a.s.
 if 
\begin_inset Formula $m\ll n\log n$
\end_inset

.
 Although the exact threshold for bounded-degree spanning trees is not known,
 it was proved in 
\begin_inset CommandInset citation
LatexCommand cite
key "Mon14"

\end_inset

 that for any 
\begin_inset Formula $\Delta$
\end_inset

 and any tree 
\begin_inset Formula $T$
\end_inset

 with maximum degree at most 
\begin_inset Formula $\Delta$
\end_inset

, a random 
\begin_inset Formula $n$
\end_inset

-vertex graph with 
\begin_inset Formula $\Delta n\left(\log n\right)^{5}$
\end_inset

 edges a.a.s.
 contains 
\begin_inset Formula $T$
\end_inset

.
 Here and from now on, all asymptotics are as 
\begin_inset Formula $n\to\infty$
\end_inset

, and we implicitly round large quantities to integers.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "BFM03"

\end_inset

, the authors studied Hamiltonicity in the random graph model that starts
 with a dense graph and adds 
\begin_inset Formula $m$
\end_inset

 random edges.
 This model is a natural generalization of the ordinary random graph model
 where we start with nothing, and offers a 
\begin_inset Quotes eld
\end_inset

hybrid
\begin_inset Quotes erd
\end_inset

 perspective combining the extremal and probabilistic settings of the last
 two paragraphs.
 The model has since been studied in a number of other contexts; see for
 example 
\begin_inset CommandInset citation
LatexCommand cite
key "BHM04,KST06,KKS15"

\end_inset

.
 A property that holds a.a.s.
 with small 
\begin_inset Formula $m$
\end_inset

 in our random graph model can be said to hold not just for a 
\begin_inset Quotes eld
\end_inset

globally
\begin_inset Quotes erd
\end_inset

 typical graph but for the typical graph in every small 
\begin_inset Quotes eld
\end_inset

neighbourhood
\begin_inset Quotes erd
\end_inset

 of our space of graphs.
 This tells us that the graphs which fail to satisfy our property are in
 some sense 
\begin_inset Quotes eld
\end_inset

fragile
\begin_inset Quotes erd
\end_inset

.
 We highlight that it is generally very easy to transfer results from our
 model of random perturbation to other natural models, including those that
 delete as well as add edges (this can be accomplished with standard coupling
 and conditioning arguments).
 We also note that a particularly important motivation is the notion of
 
\emph on
smoothed analysis
\emph default
 of algorithms introduced in 
\begin_inset CommandInset citation
LatexCommand cite
key "ST04"

\end_inset

.
 This is is a hybrid of worst-case and average-case analysis, studying the
 performance of algorithms in the more realistic setting of inputs that
 are 
\begin_inset Quotes eld
\end_inset

noisy
\begin_inset Quotes erd
\end_inset

 but not completely random.
\end_layout

\begin_layout Standard
The statement of 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1"
key "BFM03"

\end_inset

 is that for every 
\begin_inset Formula $\alpha>0$
\end_inset

 there is 
\begin_inset Formula $c=c\left(\alpha\right)$
\end_inset

 such that if we start with a graph with minimum degree at least 
\begin_inset Formula $\alpha n$
\end_inset

 and add 
\begin_inset Formula $cn$
\end_inset

 random edges, then the resulting graph will a.a.s.
 be Hamiltonian.
 This saves a logarithmic factor over the usual model where we start with
 nothing.
 Note that some dense graphs require a linear number of extra edges to become
 Hamiltonian (consider for example the complete bipartite graph with partition
 sizes 
\begin_inset Formula $n/3$
\end_inset

 and 
\begin_inset Formula $2n/3$
\end_inset

), so the order of magnitude of this result is tight.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\GG\left(n,p\right)$
\end_inset

 be the Erd
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
H{o}
\end_layout

\end_inset

s-R
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

enyi random graph model with vertex set 
\begin_inset Formula $\range n=\left\{ 1,\dots,n\right\} $
\end_inset

, where each edge is independently present with probability 
\begin_inset Formula $p$
\end_inset

.
 (For our purposes this is equivalent to the model that uniformly at random
 selects a 
\begin_inset Formula $p{n \choose 2}$
\end_inset

-edge graph on the vertex set 
\begin_inset Formula $\range n$
\end_inset

).
 In this paper we prove the following theorem, extending the aforementioned
 result to bounded-degree spanning trees.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:main-theorem"

\end_inset

There is 
\begin_inset Formula $\c=\c\left(\a,\D\right)$
\end_inset

 such that if 
\begin_inset Formula $\G$
\end_inset

 is a graph on the vertex set 
\begin_inset Formula $\range n$
\end_inset

 with minimum degree at least 
\begin_inset Formula $\a n$
\end_inset

, and 
\begin_inset Formula $\T$
\end_inset

 is an 
\begin_inset Formula $n$
\end_inset

-vertex tree with maximum degree at most 
\begin_inset Formula $\D$
\end_inset

, and 
\begin_inset Formula $\R\in\GG\left(n,\c/n\right)$
\end_inset

, then a.a.s.
 
\begin_inset Formula $\T\subseteq\G\cup\R$
\end_inset

.
\end_layout

\begin_layout Standard
One of the ingredients of the proof is the following lemma, due to Alon
 and two of the authors (
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~1.1"
key "AKS07"

\end_inset

).
 It shows that the random edges in 
\begin_inset Formula $\R$
\end_inset

 are already enough to embed almost-spanning trees.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:almost-spanning"

\end_inset

There is 
\begin_inset Formula $\c=\c\left(\varepsilon,\D\right)$
\end_inset

 such that 
\begin_inset Formula $\G\in\GG\left(n,\c/n\right)$
\end_inset

 a.a.s.
 contains every tree of maximum degree at most 
\begin_inset Formula $\D$
\end_inset

 on 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

 vertices.
\end_layout

\begin_layout Standard
We will split the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:main-theorem"

\end_inset

 into two cases in a similar way to 
\begin_inset CommandInset citation
LatexCommand cite
key "Kri10"

\end_inset

.
 If our spanning tree 
\begin_inset Formula $\T$
\end_inset

 has many leaves, then we remove the leaves and embed the resulting non-spanning
 tree in 
\begin_inset Formula $\R$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:almost-spanning"

\end_inset

.
 To complete this into our spanning tree 
\begin_inset Formula $\T$
\end_inset

, it remains to match the the vertices needing leaves with leftover vertices.
 This amounts to finding a perfect matching in a certain bipartite graph.
 The random edges in 
\begin_inset Formula $\R$
\end_inset

 provide several almost-perfect matchings on their own; we combine these
 with the dense graph 
\begin_inset Formula $\G$
\end_inset

 to satisfy the conditions of Hall's marriage theorem and guarantee the
 required perfect matching.
 The details for this case are given in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:many-leaves"

\end_inset

.
\end_layout

\begin_layout Standard
The more difficult case is where 
\begin_inset Formula $\T$
\end_inset

 has few leaves, which we attack in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:few leaves"

\end_inset

.
 In this case 
\begin_inset Formula $\T$
\end_inset

 cannot be very 
\begin_inset Quotes eld
\end_inset

complicated
\begin_inset Quotes erd
\end_inset

 and must be a subdivision of a small tree.
 In particular 
\begin_inset Formula $\T$
\end_inset

 must have many long 
\emph on
bare paths
\emph default
: paths where each vertex has degree exactly two.
 By removing these bare paths we obtain a small forest which we can embed
 into 
\begin_inset Formula $\R$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:almost-spanning"

\end_inset

 (the details are in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:embed-forest"

\end_inset

).
 In order to complete this forest into our spanning tree 
\begin_inset Formula $\T$
\end_inset

, we need to join up distinguished pairs of vertices with disjoint paths
 of certain lengths.
 In order to make this task feasible, in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:partition-into-blobs"

\end_inset

 we first use Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma to divide the vertex set into a bounded number of
 pieces, each of which induces a 
\begin_inset Quotes eld
\end_inset

super-regular pair
\begin_inset Quotes erd
\end_inset

 in 
\begin_inset Formula $\G$
\end_inset

 (that is, a dense subgraph with edges very well-distributed).
 In 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:embed-paths-between"

\end_inset

 we use 
\begin_inset Formula $\R$
\end_inset

 to find most of our desired paths, in such a way that it only remains to
 join up pairs of vertices within the same super-regular pair.
 We make some further adjustments with 
\begin_inset Formula $\R$
\end_inset

 (
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:embed-relative-sizes"

\end_inset

), after which the super-regularity of the pairs allows us to find the rest
 of our paths using a tool called the 
\begin_inset Quotes eld
\end_inset

blow-up lemma
\begin_inset Quotes erd
\end_inset

 (
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:blow-up"

\end_inset

).
\end_layout

\begin_layout Section
Proof of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
texorpdfstring{}{Theorem~}
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:main-theorem"

\end_inset


\end_layout

\begin_layout Standard
We split the random edges into multiple independent 
\begin_inset Quotes eld
\end_inset

phases
\begin_inset Quotes erd
\end_inset

: say 
\begin_inset Formula $\R\supseteq\R_{1}\cup\R_{2}\cup\R_{3}\cup\R_{4}$
\end_inset

, where 
\begin_inset Formula $\R_{i}\in\GG\left(n,\c_{i}/n\right)$
\end_inset

 for some large 
\begin_inset Formula $\c_{i}=\c_{i}\left(\a,\D\right)$
\end_inset

 to be determined later (these 
\begin_inset Formula $\c_{i}$
\end_inset

 will in turn determine 
\begin_inset Formula $\c$
\end_inset

).
 Let 
\begin_inset Formula $V=\range n$
\end_inset

 be the common vertex set of 
\begin_inset Formula $\G$
\end_inset

, 
\begin_inset Formula $\R$
\end_inset

 and the 
\begin_inset Formula $\R_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Case 1: 
\begin_inset Formula $\T$
\end_inset

 has many leaves
\begin_inset CommandInset label
LatexCommand label
name "sub:many-leaves"

\end_inset


\end_layout

\begin_layout Standard
For our first case suppose there are at least 
\begin_inset Formula $\lambda n$
\end_inset

 leaves in 
\begin_inset Formula $\T$
\end_inset

 (for some fixed 
\begin_inset Formula $\lambda=\lambda\left(\a\right)>0$
\end_inset

 to be determined in the second case).
 Then consider the tree 
\begin_inset Formula $\T'$
\end_inset

 with some 
\begin_inset Formula $\lambda n$
\end_inset

 leaves removed.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:almost-spanning"

\end_inset

 we can a.a.s.
 embed 
\begin_inset Formula $\T'$
\end_inset

 into 
\begin_inset Formula $\R_{1}$
\end_inset

.
 Let 
\begin_inset Formula $A'\subseteq V$
\end_inset

 be the set of vertices of 
\begin_inset Formula $\T'$
\end_inset

 which had a leaf deleted from them, and let 
\begin_inset Formula $B\subseteq V$
\end_inset

 be the set of 
\begin_inset Formula $\lambda n$
\end_inset

 vertices not part of 
\begin_inset Formula $\T'$
\end_inset

.
 We can assume 
\begin_inset Formula $A'$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are uniformly random disjoint sets of the appropriate size (note 
\begin_inset Formula $\left|A'\right|\ge\lambda n/\D$
\end_inset

 and 
\begin_inset Formula $\left|B\right|=\lambda n$
\end_inset

).
 For each 
\begin_inset Formula $a\in A'$
\end_inset

, the random variable 
\begin_inset Formula $\left|N_{\G}\left(a\right)\cap B\right|$
\end_inset

 is hypergeometrically distributed with expected value 
\begin_inset Formula $\lambda\a n$
\end_inset

, and similarly each 
\begin_inset Formula $\left|N_{\G}\left(b\right)\cap A'\right|$
\end_inset

 (
\begin_inset Formula $b\in B$
\end_inset

) is hypergeometric with expectation at least 
\begin_inset Formula $\lambda\a n/\D$
\end_inset

.
 Let 
\begin_inset Formula $\beta=\lambda\a/\left(2\D\right)$
\end_inset

; by a concentration inequality (for example, see 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem 2.10"
key "JLR00"

\end_inset

) and the union bound, in 
\begin_inset Formula $\G$
\end_inset

 each 
\begin_inset Formula $a'\in A'$
\end_inset

 a.a.s.
 has at least 
\begin_inset Formula $\beta n$
\end_inset

 neighbours in 
\begin_inset Formula $B$
\end_inset

, and each 
\begin_inset Formula $b\in B$
\end_inset

 a.a.s.
 has at least 
\begin_inset Formula $\beta n$
\end_inset

 neighbours in 
\begin_inset Formula $A'$
\end_inset

.
 From now on we treat 
\begin_inset Formula $A'$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 as fixed sets satisfying these properties.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $A$
\end_inset

 be a set consisting of 
\begin_inset Formula $\ell$
\end_inset

 copies of each vertex 
\begin_inset Formula $a'\in A'$
\end_inset

 which needs 
\begin_inset Formula $\ell$
\end_inset

 extra leaves (so 
\begin_inset Formula $\left|A\right|=\lambda n$
\end_inset

).
 Define a bipartite graph 
\begin_inset Formula $\B{\G}$
\end_inset

 on the vertex set 
\begin_inset Formula $A\cup B$
\end_inset

, with an edge between 
\begin_inset Formula $a\in A$
\end_inset

 (a copy of 
\begin_inset Formula $a'\in A'$
\end_inset

) and 
\begin_inset Formula $b\in B$
\end_inset

, if there is an edge between 
\begin_inset Formula $a'$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 in 
\begin_inset Formula $\G$
\end_inset

.
 Similarly define 
\begin_inset Formula $\B{\R_{2}}$
\end_inset

 and 
\begin_inset Formula $\B{\G\cup\R}$
\end_inset

 with edges deriving from 
\begin_inset Formula $\R_{2}$
\end_inset

 and 
\begin_inset Formula $\G\cup\R$
\end_inset

.
 If we can find a perfect matching in 
\begin_inset Formula $\B{\G}\cup\B{\R_{2}}\subseteq\B{\G\cup\R}$
\end_inset

, this gives us a way to extend our embedding of 
\begin_inset Formula $\T'$
\end_inset

 to an embedding of 
\begin_inset Formula $\T$
\end_inset

, as desired.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\BB_{A,B}\left(p\right)$
\end_inset

 be the random bipartite graph distribution where each of the 
\begin_inset Formula $\left|A\right|\left|B\right|$
\end_inset

 possible edges between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are present with probability 
\begin_inset Formula $p$
\end_inset

.
 For any 
\begin_inset Formula $\c_{\BB}$
\end_inset

, we can choose large 
\begin_inset Formula $\c_{2}$
\end_inset

 such that for any 
\begin_inset Formula $a'\in A$
\end_inset

 and 
\begin_inset Formula $b\in B$
\end_inset

, and for large 
\begin_inset Formula $n$
\end_inset

, 
\begin_inset Formula 
\begin{align*}
 & \Pr\left(\mbox{all copies of }a'\mbox{ are adjacent to }b\mbox{ in }\B{\R_{2}}\right)=\c_{2}/n\\
 & \quad\ge1-\left(1-\c_{\BB}/n\right)^{\Delta}=\Pr\left(\mbox{some copy of }a'\mbox{ is adjacent to }b\mbox{ in }\BB_{A,B}\left(\c_{\BB}/n\right)\right).
\end{align*}

\end_inset

This means we can couple 
\begin_inset Formula $\B{\R_{2}}$
\end_inset

 and 
\begin_inset Formula $G_{\BB}\in\BB_{A,B}\left(\c_{\BB}/n\right)$
\end_inset

 in such a way that 
\begin_inset Formula $\B{\R_{2}}\supseteq G_{\BB}$
\end_inset

 (the distribution of 
\begin_inset Formula $\B{\R_{2}}$
\end_inset

 
\emph on
stochastically dominates
\emph default
 
\begin_inset Formula $\BB_{A,B}\left(\c_{\BB}/n\right)$
\end_inset

).
 The following lemma then provides the desired perfect matching.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:bipartite-perfect-matching"

\end_inset

Let 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 be 
\begin_inset Formula $n$
\end_inset

-vertex sets.
 There is 
\begin_inset Formula $\c_{\BB}=\c_{\BB}\left(\a\right)$
\end_inset

 such that if 
\begin_inset Formula $\G$
\end_inset

 is a bipartite graph with bipartition 
\begin_inset Formula $A\cup B$
\end_inset

 and minimum degree at least 
\begin_inset Formula $\a n$
\end_inset

, and if 
\begin_inset Formula $\R\in\BB_{A,B}\left(\c_{\BB}/n\right)$
\end_inset

, then a.a.s.
 
\begin_inset Formula $\G\cup\R$
\end_inset

 has a perfect matching.
\end_layout

\begin_layout Standard
In order to prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-perfect-matching"

\end_inset

 we need another lemma.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:bipartite-matching"

\end_inset

Let 
\begin_inset Formula $\varepsilon>0$
\end_inset

, and let 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 be 
\begin_inset Formula $n$
\end_inset

-vertex sets.
 There is 
\begin_inset Formula $\c=\c\left(\varepsilon\right)$
\end_inset

 such that 
\begin_inset Formula $\R\in\BB_{A,B}\left(\c/n\right)$
\end_inset

 has a matching of size 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

.
\end_layout

\begin_layout Proof
For any subsets 
\begin_inset Formula $A'$
\end_inset

 and 
\begin_inset Formula $B'$
\end_inset

 of size 
\begin_inset Formula $\varepsilon n$
\end_inset

, the probability there is no edge between 
\begin_inset Formula $A'$
\end_inset

 and 
\begin_inset Formula $B'$
\end_inset

 is 
\begin_inset Formula $\left(1-\c/n\right)^{\left(\varepsilon n\right)^{2}}\le e^{-\c\varepsilon^{2}n}$
\end_inset

.
 There are at most 
\begin_inset Formula $2^{2n}$
\end_inset

 choices of such 
\begin_inset Formula $A',B'$
\end_inset

, so for large 
\begin_inset Formula $\c$
\end_inset

, by the union bound there is a.a.s.
 an edge between any such pair of sets.
 It follows that a maximum-size matching a.a.s.
 has at least 
\begin_inset Formula $\left(1-\varepsilon\right)n$
\end_inset

 edges.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-perfect-matching"

\end_inset


\end_layout

\end_inset

We apply Hall's marriage theorem.
 If 
\begin_inset Formula $W\subseteq A$
\end_inset

 with 
\begin_inset Formula $\left|W\right|\le\a n$
\end_inset

 then 
\begin_inset Formula $\left|N_{\G}\left(W\right)\right|\ge\a n\ge\left|W\right|$
\end_inset

 by the minimum degree condition on 
\begin_inset Formula $\G$
\end_inset

.
 Similarly, every vertex outside 
\begin_inset Formula $N_{\G}\left(W\right)$
\end_inset

 has at least 
\begin_inset Formula $\a n$
\end_inset

 neighbours outside 
\begin_inset Formula $W$
\end_inset

, so if 
\begin_inset Formula $\left|W\right|\ge\left(1-\a\right)n$
\end_inset

 then 
\begin_inset Formula $\left|N_{\G}\left(W\right)\right|=n\ge\left|W\right|$
\end_inset

.
 So, consider any 
\begin_inset Formula $W$
\end_inset

 with 
\begin_inset Formula $\a n\le\left|W\right|\le\left(1-\a\right)n$
\end_inset

 (in which case we must have 
\begin_inset Formula $\a\le1/2$
\end_inset

).
 Split 
\begin_inset Formula $\R$
\end_inset

 into phases 
\begin_inset Formula $\R\supseteq\R_{1}\cup\dots\cup\R_{r}$
\end_inset

, with 
\begin_inset Formula $\R_{i}\in\BB_{A,B}\left(\c'/n\right)$
\end_inset

, for some 
\begin_inset Formula $\c'=\c'\left(\a\right)$
\end_inset

 and 
\begin_inset Formula $r=r\left(\a\right)$
\end_inset

 to be determined.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-matching"

\end_inset

, if 
\begin_inset Formula $\c'$
\end_inset

 is large we can find a 
\begin_inset Formula $\left(1-\a/8\right)n$
\end_inset

-edge matching 
\begin_inset Formula $M_{i}$
\end_inset

 in each 
\begin_inset Formula $\R_{i}$
\end_inset

.
 Let 
\begin_inset Formula $N_{i}=N_{M_{i}}\left(W\right)$
\end_inset

 contain the vertices matched with 
\begin_inset Formula $W$
\end_inset

 in each 
\begin_inset Formula $M_{i}$
\end_inset

, and note that each 
\begin_inset Formula $N_{i}$
\end_inset

 is a random set satisfying 
\begin_inset Formula $\left|W\right|-\a n/8\le\left|N_{i}\right|\le\left|W\right|$
\end_inset

.
 Condition on 
\begin_inset Formula $N_{1}$
\end_inset

, and condition on the number of vertices 
\begin_inset Formula $\left|N_{i}\right|$
\end_inset

 matched by 
\begin_inset Formula $W$
\end_inset

 in each 
\begin_inset Formula $M_{i}$
\end_inset

.
 Now, for each 
\begin_inset Formula $i>1$
\end_inset

, note that 
\begin_inset Formula $\left|N_{i}\cap N_{1}\right|$
\end_inset

 is hypergeometrically distributed with mean 
\begin_inset Formula $\left|N_{i}\right|\left|N_{1}\right|/n$
\end_inset

.
 Since 
\begin_inset Formula $\left|W\right|\left(n-\left|W\right|\right)\ge\a n\left(1-\a\right)n\ge\a n^{2}/2$
\end_inset

, we have 
\begin_inset Formula $\left|W\right|^{2}\le\left|W\right|n-\a n^{2}/2$
\end_inset

 and 
\begin_inset Formula 
\[
\left|N_{i}\right|\left|N_{1}\right|/n\le\left|W\right|^{2}/n\le\left|W\right|-\a n/2=2\left(\left|W\right|-\a/8\right)-\left|W\right|-\a/4\le\left|N_{i}\right|+\left|N_{1}\right|-\left|W\right|-\a n/4.
\]

\end_inset

So, by a concentration inequality,
\begin_inset Formula 
\[
\Pr\left(\left|N_{i}\cup N_{1}\right|<\left|W\right|\right)=\Pr\left(\left|N_{i}\cap N_{1}\right|>\left|N_{i}\right|+\left|N_{1}\right|-\left|W\right|\right)=e^{-\Omega\left(\a^{2}n\right)}
\]

\end_inset

and therefore
\begin_inset Formula 
\[
\Pr\left(\left|N_{\R}\left(W\right)\right|<\left|W\right|\right)\le\prod_{i=2}^{r}\Pr\left(\left|N_{i}\cup N_{1}\right|<\left|W\right|\right)=e^{-\Omega\left(r\a^{2}n\right)}.
\]

\end_inset

If 
\begin_inset Formula $r$
\end_inset

 is large this probability is 
\begin_inset Formula $o\left(2^{-n}\right)$
\end_inset

, and since there are at most 
\begin_inset Formula $2^{n}$
\end_inset

 choices for 
\begin_inset Formula $W$
\end_inset

, the union bound gives 
\begin_inset Formula $\left|N_{\R}\left(W\right)\right|\ge\left|W\right|$
\end_inset

 for all required 
\begin_inset Formula $W$
\end_inset

.
\end_layout

\begin_layout Subsection
Case 2: 
\begin_inset Formula $\T$
\end_inset

 has few leaves
\begin_inset CommandInset label
LatexCommand label
name "sub:few leaves"

\end_inset


\end_layout

\begin_layout Standard
Now we address the second case where there are fewer than 
\begin_inset Formula $\lambda n$
\end_inset

 leaves in 
\begin_inset Formula $\T$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Partitioning into super-regular pairs
\begin_inset CommandInset label
LatexCommand label
name "sub:partition-into-blobs"

\end_inset


\end_layout

\begin_layout Standard
As outlined, we first need to divide 
\begin_inset Formula $G$
\end_inset

 into a bounded number of pairs of clusters with edges well-distributed
 between them.
 This partition will inform the way we use 
\begin_inset Formula $\R$
\end_inset

 to embed 
\begin_inset Formula $\T$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\h}{h}
{\boldsymbol{h}}
\end_inset


\end_layout

\begin_layout Definition
For a disjoint pair of vertex sets 
\begin_inset Formula $\left(X,Y\right)$
\end_inset

 in a graph, let its 
\emph on
density
\emph default
 
\begin_inset Formula $d\left(X,Y\right)$
\end_inset

 be the number of edges between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

, divided by 
\begin_inset Formula $\left|X\right|\left|Y\right|$
\end_inset

.
 A pair of vertex sets 
\begin_inset Formula $\left(V_{1},V_{2}\right)$
\end_inset

 is said to be 
\emph on

\begin_inset Formula $\varepsilon$
\end_inset

-regular
\emph default
 if for any 
\begin_inset Formula $U_{1},U_{2}$
\end_inset

 with 
\begin_inset Formula $U_{\h}\subseteq V_{\h}$
\end_inset

 and 
\begin_inset Formula $\left|U_{\h}\right|\ge\varepsilon\left|V_{\h}\right|$
\end_inset

, we have 
\begin_inset Formula $\left|d\left(U_{1},U_{2}\right)-d\left(V_{1},V_{2}\right)\right|\le\varepsilon$
\end_inset

.
 If alternatively 
\begin_inset Formula $d\left(U_{1},U_{2}\right)\ge\delta$
\end_inset

 for all such pairs 
\begin_inset Formula $U_{1},U_{2}$
\end_inset

 then we say 
\begin_inset Formula $\left(V_{1},V_{2}\right)$
\end_inset

 is 
\emph on

\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense
\emph default
.
 Let 
\begin_inset Formula $\flip{\h}=2-\h$
\end_inset

; if 
\begin_inset Formula $\left(V_{1},V_{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense and moreover each 
\begin_inset Formula $v\in V_{\h}$
\end_inset

 has at least 
\begin_inset Formula $\delta\left|V_{\flip{\h}}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $V_{\flip{\h}}$
\end_inset

, then we say 
\begin_inset Formula $\left(V_{1},V_{2}\right)$
\end_inset

 is 
\emph on

\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-super-regular
\emph default
.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:partition-into-blobs"

\end_inset

For 
\begin_inset Formula $\a,\varepsilon>0$
\end_inset

 with 
\begin_inset Formula $\varepsilon$
\end_inset

 sufficiently small relative to 
\begin_inset Formula $\a$
\end_inset

, there are 
\begin_inset Formula $\delta=\delta\left(\a\right)>0$
\end_inset

, 
\begin_inset Formula $M=M\left(\a,\varepsilon\right)$
\end_inset

, 
\begin_inset Formula $a=a\left(\a,\varepsilon\right)>0$
\end_inset

 and 
\begin_inset Formula $b=b\left(\a,\varepsilon\right)>0$
\end_inset

 such that the following holds.
 Let 
\begin_inset Formula $\G$
\end_inset

 be a graph on 
\begin_inset Formula $\range n$
\end_inset

 with minimum degree at least 
\begin_inset Formula $\a n$
\end_inset

.
 We can choose 
\begin_inset Formula $q\le M$
\end_inset

 and partition 
\begin_inset Formula $\range n$
\end_inset

 into sets 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

 (
\begin_inset Formula $1\le i\le q$
\end_inset

, 
\begin_inset Formula $\h=1,2$
\end_inset

) such that each 
\begin_inset Formula $an\le\left|V_{i}^{\h}\right|\le bn$
\end_inset

 and each pair 
\begin_inset Formula $\left(V_{i}^{1},V_{i}^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-super-regular.
\end_layout

\begin_layout Standard
To prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partition-into-blobs"

\end_inset

, we will apply Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma to obtain a reduced 
\emph on
cluster graph
\emph default
, then decompose this cluster graph into small stars.
 In each star 
\begin_inset Formula $T_{i}$
\end_inset

, the centre cluster will correspond to 
\begin_inset Formula $V_{i}^{1}$
\end_inset

 and the leaf clusters will be combined to form 
\begin_inset Formula $V_{i}^{2}$
\end_inset

.
 We will then have to redistribute some of the vertices to ensure super-regulari
ty.
 Before giving the details of the proof, we give a statement of (a version
 of) Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma and some auxiliary lemmas for working with regularity
 and super-regularity.
\end_layout

\begin_layout Lemma
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma, minimum degree form
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "lem:szemeredi-regularity"

\end_inset

For every 
\begin_inset Formula $\a>0$
\end_inset

, and any 
\begin_inset Formula $\varepsilon>0$
\end_inset

 that is sufficiently small relative to 
\begin_inset Formula $\a$
\end_inset

, there is 
\begin_inset Formula $\a'=\a'\left(\a\right)>0$
\end_inset

 and 
\begin_inset Formula $K=K\left(\varepsilon\right)$
\end_inset

 such that the following holds.
 For any graph 
\begin_inset Formula $\G$
\end_inset

 of minimum degree at least 
\begin_inset Formula $\a\left|\G\right|$
\end_inset

, there is a partition of 
\begin_inset Formula $V\left(\G\right)$
\end_inset

 into clusters 
\begin_inset Formula $V_{0},V_{1},\dots V_{k}$
\end_inset

 (
\begin_inset Formula $k\le K$
\end_inset

), and a spanning subgraph 
\begin_inset Formula $\G'$
\end_inset

 of 
\begin_inset Formula $\G$
\end_inset

, satisfying the following properties.
 The 
\begin_inset Quotes eld
\end_inset

exceptional cluster
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $V_{0}$
\end_inset

 has size at most 
\begin_inset Formula $\varepsilon n$
\end_inset

, and the other clusters have equal size 
\begin_inset Formula $sn$
\end_inset

.
 The minimum degree of 
\begin_inset Formula $\G'$
\end_inset

 is at least 
\begin_inset Formula $\a'n$
\end_inset

.
 There are no edges of 
\begin_inset Formula $\G'$
\end_inset

 within clusters, and each pair of non-exceptional clusters is 
\begin_inset Formula $\varepsilon$
\end_inset

-regular in 
\begin_inset Formula $\G'$
\end_inset

 with density zero or at least 
\begin_inset Formula $\a'$
\end_inset

.
 Moreover, define the 
\emph on
cluster graph
\emph default
 
\begin_inset Formula $C$
\end_inset

 as the graph whose vertices are the 
\begin_inset Formula $k$
\end_inset

 non-exceptional clusters 
\begin_inset Formula $V_{i}$
\end_inset

, and whose edges are the pairs of clusters between which there is nonzero
 density in 
\begin_inset Formula $\G'$
\end_inset

.
 The minimum degree of 
\begin_inset Formula $C$
\end_inset

 is at least 
\begin_inset Formula $\a'k$
\end_inset

.
\end_layout

\begin_layout Standard
This version of Szemeredi's regularity lemma follows directly from 
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition~9"
key "KOT05"

\end_inset

.
\end_layout

\begin_layout Standard
Before we proceed to the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partition-into-blobs"

\end_inset

, we give some simple lemmas about 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-denseness.
 Note that 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-denseness is basically a one-sided version of 
\begin_inset Formula $\varepsilon$
\end_inset

-regularity that is more convenient in proofs about super-regularity.
 Here and in later sections, most of the theorems about 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense pairs correspond to analogous theorems for 
\begin_inset Formula $\varepsilon$
\end_inset

-regular pairs with density about 
\begin_inset Formula $\delta$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:combine-clusters"

\end_inset

Suppose 
\begin_inset Formula $V_{1},\dots,V_{r}$
\end_inset

 are clusters of the same sizes such that each 
\begin_inset Formula $\left(V^{1},V_{i}^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense.
 Let 
\begin_inset Formula $V^{2}=\bigcup_{i=1}^{r}V_{i}^{2}$
\end_inset

; then 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta/r\right)$
\end_inset

-dense.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $U^{\h}\subseteq V^{\h}$
\end_inset

 with 
\begin_inset Formula $\left|U^{\h}\right|\ge\varepsilon\left|V^{\h}\right|$
\end_inset

.
 Let 
\begin_inset Formula $V_{i}^{2}$
\end_inset

 be the cluster which has the largest intersection with 
\begin_inset Formula $U^{2}$
\end_inset

, so we have 
\begin_inset Formula $\left|U^{2}\cap V_{i}^{2}\right|\ge\varepsilon\left|V^{2}\right|/r=\varepsilon\left|V_{i}^{2}\right|$
\end_inset

, and there are therefore at least 
\begin_inset Formula $\delta\left|U^{1}\right|\left|U^{2}\cap V_{i}^{2}\right|\ge\left(\delta/r\right)\left|U^{1}\right|\left|U^{2}\right|$
\end_inset

 edges between 
\begin_inset Formula $U^{1}$
\end_inset

 and 
\begin_inset Formula $U^{2}$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:robust-regular"

\end_inset

Let 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 be an 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense pair, let 
\begin_inset Formula $0\le\gamma\le1$
\end_inset

, and let 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

 be a pair such that each 
\begin_inset Formula $\left|V^{\h}\triangle W^{\h}\right|\le\gamma\left|V^{\h}\right|$
\end_inset

.
 Then 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

 is an 
\begin_inset Formula $\left(\varepsilon',\delta'\right)$
\end_inset

-dense pair, with 
\begin_inset Formula $\varepsilon'=\varepsilon+6\sqrt{\gamma/\left(1+\gamma\right)}$
\end_inset

 and 
\begin_inset Formula $\delta'=\delta-4\sqrt{\gamma/\left(1+\gamma\right)}$
\end_inset

 If moreover 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-super-regular and each vertex in 
\begin_inset Formula $W^{\h}$
\end_inset

 has at least 
\begin_inset Formula $\delta\left|W^{\flip{\h}}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $W^{\flip{\h}}$
\end_inset

, then 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

 is an 
\begin_inset Formula $\left(\varepsilon',\delta'\right)$
\end_inset

-super-regular pair.
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:robust-regular"

\end_inset

 says that regularity-type properties are 
\begin_inset Quotes eld
\end_inset

robust
\begin_inset Quotes erd
\end_inset

 with respect to small alterations of the clusters.
 It is almost the same as 
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition~8"
key "BST08"

\end_inset

, and has exactly the same proof.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:regular-contains-superregular"

\end_inset

Every 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense pair 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 contains a 
\begin_inset Formula $\left(\varepsilon/\left(1-\varepsilon\right),\delta-\varepsilon\right)$
\end_inset

-super-regular sub-pair 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

, where 
\begin_inset Formula $\left|W^{\h}\right|\ge\left(1-\varepsilon\right)\left|V^{\h}\right|$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:regular-contains-superregular"

\end_inset

 follows easily from the same proof as 
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition~6"
key "BST08"

\end_inset

.
\end_layout

\begin_layout Standard
Now we prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partition-into-blobs"

\end_inset

.
 First we need a lemma for our decomposition into small stars.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:star-cover"

\end_inset

Let 
\begin_inset Formula $G$
\end_inset

 be an 
\begin_inset Formula $n$
\end_inset

-vertex graph with minimum degree at least 
\begin_inset Formula $\a n$
\end_inset

.
 Then there is a spanning subgraph 
\begin_inset Formula $Q$
\end_inset

 which is a union of vertex-disjoint stars, each with at least two and at
 most 
\begin_inset Formula $1+1/\a$
\end_inset

 vertices.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $Q$
\end_inset

 be a union of such stars with the maximum number of vertices.
 Suppose there is a vertex 
\begin_inset Formula $v$
\end_inset

 uncovered by 
\begin_inset Formula $Q$
\end_inset

.
 If 
\begin_inset Formula $v$
\end_inset

 has a neighbour which is a centre of one of the stars in 
\begin_inset Formula $Q$
\end_inset

, and that star has fewer than 
\begin_inset Formula $1+1/\a$
\end_inset

 vertices, then we could add 
\begin_inset Formula $v$
\end_inset

 to that star, contradicting maximality.
 (Here we allow either vertex of a 2-vertex star to be considered the 
\begin_inset Quotes eld
\end_inset

centre
\begin_inset Quotes erd
\end_inset

).
 Otherwise, if 
\begin_inset Formula $v$
\end_inset

 has a neighbour 
\begin_inset Formula $w$
\end_inset

 which is a leaf of one of the stars in 
\begin_inset Formula $Q$
\end_inset

, then we could remove that leaf from its star and create a new 2-vertex
 star with edge 
\begin_inset Formula $vw$
\end_inset

, again contradicting maximality.
 The remaining case is where each of the (at least 
\begin_inset Formula $\a n$
\end_inset

) neighbours of 
\begin_inset Formula $v$
\end_inset

 is a centre of a star with 
\begin_inset Formula $1+\floor{1/\a}>1/\a$
\end_inset

 vertices.
 But these stars would comprise more than 
\begin_inset Formula $n$
\end_inset

 vertices, which is again a contradiction.
 We conclude that 
\begin_inset Formula $Q$
\end_inset

 covers 
\begin_inset Formula $G$
\end_inset

, as desired.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partition-into-blobs"

\end_inset


\end_layout

\end_inset

Apply our minimum degree form of Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma, with some 
\begin_inset Formula $\varepsilon'$
\end_inset

 to be determined (which we will repeatedly assume is sufficiently small).
 Let 
\begin_inset Formula $Q$
\end_inset

 be a cover of 
\begin_inset Formula $C$
\end_inset

 by stars 
\begin_inset Formula $T_{1},\dots,T_{q}$
\end_inset

 of size at most 
\begin_inset Formula $1/\a'$
\end_inset

, as guaranteed by 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:star-cover"

\end_inset

.
 Let 
\begin_inset Formula $W_{i}^{1}$
\end_inset

 be the centre cluster of 
\begin_inset Formula $T_{i}$
\end_inset

, and let 
\begin_inset Formula $W_{i}^{2}$
\end_inset

 be the union of the leaf clusters of 
\begin_inset Formula $T_{i}$
\end_inset

 (for two-vertex stars, arbitrarily choose one vertex as the 
\begin_inset Quotes eld
\end_inset

leaf
\begin_inset Quotes erd
\end_inset

 and one as the 
\begin_inset Quotes eld
\end_inset

centre
\begin_inset Quotes erd
\end_inset

).
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:combine-clusters"

\end_inset

, with 
\begin_inset Formula $\delta'=\left(\a'\right)^{2}/2$
\end_inset

 each pair 
\begin_inset Formula $\left(W_{i}^{1},W_{i}^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon',\delta'\right)$
\end_inset

-dense in 
\begin_inset Formula $\G'$
\end_inset

 (therefore 
\begin_inset Formula $\G$
\end_inset

).
\end_layout

\begin_layout Proof
Apply 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:regular-contains-superregular"

\end_inset

 to obtain sets 
\begin_inset Formula $V_{i}^{\h}\subseteq W_{i}^{\h}$
\end_inset

 such that 
\begin_inset Formula $\left|V_{i}^{\h}\right|=\left(1-\varepsilon'\right)\left|W_{i}^{\h}\right|$
\end_inset

 and each 
\begin_inset Formula $\left(V_{i}^{1},V_{i}^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(2\varepsilon',\delta''\right)$
\end_inset

-super-regular, for 
\begin_inset Formula $\delta''=\delta'/2$
\end_inset

.
 Combining the exceptional cluster 
\begin_inset Formula $V_{0}$
\end_inset

 and all the 
\begin_inset Formula $W_{i}^{\h}\backslash V_{i}^{\h}$
\end_inset

, there are at most 
\begin_inset Formula $2\varepsilon'n$
\end_inset

 
\begin_inset Quotes eld
\end_inset

bad
\begin_inset Quotes erd
\end_inset

 vertices not part of a super-regular pair.
\end_layout

\begin_layout Proof
Each bad vertex 
\begin_inset Formula $v$
\end_inset

 has at least 
\begin_inset Formula $\a'n-2\varepsilon'n$
\end_inset

 neighbours to the clusters 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

.
 The clusters 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

 which have fewer than 
\begin_inset Formula $\delta''\left|V_{i}^{\h}\right|$
\end_inset

 such neighbours contain at most 
\begin_inset Formula $\delta''n$
\end_inset

 of these neighbours.
 Each 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

 has size at most 
\begin_inset Formula $sn/\a'$
\end_inset

, so for small 
\begin_inset Formula $\varepsilon'$
\end_inset

 there are at least
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\frac{\a'n-2\varepsilon'n-\delta''n}{sn/\a'}\ge\left(\a'\right)^{2}/\left(2s\right)
\]

\end_inset

clusters 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

 which have at least 
\begin_inset Formula $\delta''s\left(1-\varepsilon'\right)n$
\end_inset

 neighbours of 
\begin_inset Formula $v$
\end_inset

.
 Put 
\begin_inset Formula $v$
\end_inset

 in one of these clusters uniformly at random (do this independently for
 each bad 
\begin_inset Formula $v$
\end_inset

).
 By a concentration inequality, after this procedure a.a.s.
 at most 
\begin_inset Formula $2\left(2\varepsilon'n\right)/\left(\left(\a'\right)^{2}/\left(2s\right)\right)\le\left(8\varepsilon'/\left(\a'\right)^{2}\right)\left|W_{i}^{\h}\right|\le\left(9\varepsilon'/\left(\a'\right)^{2}\right)\left|V_{i}^{\h}\right|$
\end_inset

 bad vertices have been added to each 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:robust-regular"

\end_inset

, for small 
\begin_inset Formula $\varepsilon'$
\end_inset

 each 
\begin_inset Formula $\left(V_{i}^{1},V_{i}^{2}\right)$
\end_inset

 is now 
\begin_inset Formula $\left(O\left(\sqrt{\varepsilon'}\right),\delta''/2\right)$
\end_inset

-super-regular.
 With 
\begin_inset Formula $\delta=\delta''/2$
\end_inset

, 
\begin_inset Formula $a=s/2$
\end_inset

 and 
\begin_inset Formula $b=2s/\a'$
\end_inset

, and 
\begin_inset Formula $\varepsilon'$
\end_inset

 small relative to 
\begin_inset Formula $\varepsilon$
\end_inset

, we are done.
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\bi}{\mathbf{i}}
{\boldsymbol{\mathbf{i}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\bj}{\mathbf{j}}
{\boldsymbol{\mathbf{j}}}
\end_inset


\end_layout

\begin_layout Standard
We apply 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partition-into-blobs"

\end_inset

 to our graph 
\begin_inset Formula $\G$
\end_inset

, with 
\begin_inset Formula $\varepsilon=\varepsilon\left(\delta\right)$
\end_inset

 to be determined.
 For 
\begin_inset Formula $\bi=\left(i,\h\right)$
\end_inset

, let 
\begin_inset Formula $V_{\bi}=V_{i}^{\h}$
\end_inset

, and let 
\begin_inset Formula $\left|V_{\bi}\right|=s_{\bi}n$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Embedding a small subforest of 
\begin_inset Formula $\T$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sub:embed-forest"

\end_inset


\end_layout

\begin_layout Standard
Recall that a 
\emph on
bare path
\emph default
 in 
\begin_inset Formula $\T$
\end_inset

 is a path 
\begin_inset Formula $P$
\end_inset

 such that every vertex of 
\begin_inset Formula $P$
\end_inset

 has degree exactly two in 
\begin_inset Formula $\T$
\end_inset

.
 Proceeding with the proof outline, we need the fact that 
\begin_inset Formula $\T$
\end_inset

 is almost entirely composed of bare paths, as is guaranteed by the following
 lemma.
\end_layout

\begin_layout Lemma
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
after "Lemma~2.1"
key "Kri10"

\end_inset


\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "lem:bare-paths-if-no-leaves"

\end_inset

Let 
\begin_inset Formula $\T$
\end_inset

 be a tree on 
\begin_inset Formula $n$
\end_inset

 vertices with at most 
\begin_inset Formula $\ell$
\end_inset

 leaves.
 Then 
\begin_inset Formula $\T$
\end_inset

 contains a collection of at least 
\begin_inset Formula $\left(n-\left(2\ell-2\right)\left(k+1\right)\right)/\left(k+1\right)$
\end_inset

 vertex-disjoint bare paths of length 
\begin_inset Formula $k$
\end_inset

 each.
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\r}[1]{r\left(#1\right)}
{\boldsymbol{r\left(#1\right)}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\x}{x}
{\boldsymbol{x}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\y}{y}
{\boldsymbol{y}}
\end_inset


\end_layout

\begin_layout Standard
In our case 
\begin_inset Formula $\ell=\lambda n$
\end_inset

.
 If we choose 
\begin_inset Formula $k$
\end_inset

 large enough and 
\begin_inset Formula $\lambda$
\end_inset

 small enough, then 
\begin_inset Formula $\T$
\end_inset

 contains a collection of 
\begin_inset Formula $\psi n:=n/\left(2\left(k-1\right)\right)$
\end_inset

 disjoint bare 
\begin_inset Formula $k$
\end_inset

-paths.
 (We also impose that 
\begin_inset Formula $k$
\end_inset

 is odd, for reasons that will become clear later).
 If we delete the interior vertices of these paths, then we are left with
 a forest 
\begin_inset Formula $\F$
\end_inset

 on 
\begin_inset Formula $n/2$
\end_inset

 vertices.
\end_layout

\begin_layout Standard
Now, embed 
\begin_inset Formula $\F$
\end_inset

 into 
\begin_inset Formula $\R_{1}$
\end_inset

.
 There are 
\begin_inset Formula $\psi n$
\end_inset

 
\begin_inset Quotes eld
\end_inset

special pairs
\begin_inset Quotes erd
\end_inset

 of vertices of 
\begin_inset Formula $\F\subseteq\R_{1}$
\end_inset

 that need to be connected with 
\begin_inset Formula $k$
\end_inset

-paths.
 We call such connecting paths 
\begin_inset Quotes eld
\end_inset

special paths
\begin_inset Quotes erd
\end_inset

.
 For each special pair, arbitrarily choose one vertex to be 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\x$
\end_inset

-type
\begin_inset Quotes erd
\end_inset

 and the other to be 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\y$
\end_inset

-type
\begin_inset Quotes erd
\end_inset

.
 Let 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 be the set of 
\begin_inset Formula $\x$
\end_inset

-type and 
\begin_inset Formula $\y$
\end_inset

-type vertices, respectively.
 By symmetry we can assume 
\begin_inset Formula 
\[
X\,\cup\,Y\,\cup\,\F\backslash\left(X\cup Y\right)\,\cup\,V\backslash\F
\]

\end_inset

is a uniformly random partition of 
\begin_inset Formula $V$
\end_inset

 into parts of sizes 
\begin_inset Formula $\psi n$
\end_inset

, 
\begin_inset Formula $\psi n$
\end_inset

, 
\begin_inset Formula $n/2-2\psi n$
\end_inset

, 
\begin_inset Formula $n/2$
\end_inset

, and that the special pairs correspond to a uniformly random bijection
 between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

.
 Let 
\begin_inset Formula $X_{\bi}=V_{\bi}\cap X$
\end_inset

 and 
\begin_inset Formula $Y_{\bi}=V_{\bi}\cap Y$
\end_inset

, and let 
\begin_inset Formula $Z_{\bi,\bj}$
\end_inset

 be the set of special pairs in 
\begin_inset Formula $X_{\bi}\times Y_{\bj}$
\end_inset

.
 Let 
\begin_inset Formula $X_{\bi,\bj}\subseteq X_{\bi}$
\end_inset

 and 
\begin_inset Formula $Y_{\bi,\bj}\subseteq Y_{\bj}$
\end_inset

 be the set of 
\begin_inset Formula $\x$
\end_inset

-type and 
\begin_inset Formula $\y$
\end_inset

-type vertices in pairs in 
\begin_inset Formula $Z_{\bi,\bj}$
\end_inset

, respectively.
 Also let 
\begin_inset Formula $W_{\bi}=V_{\bi}\backslash F$
\end_inset

 be the set of 
\begin_inset Quotes eld
\end_inset

free
\begin_inset Quotes erd
\end_inset

 vertices remaining in 
\begin_inset Formula $V_{\bi}$
\end_inset

.
\end_layout

\begin_layout Standard
By a concentration inequality for the hypergeometric distribution and the
 union bound, a.a.s.
 each 
\begin_inset Formula $\left|W_{\bi}\right|\sim s_{\bi}n/2$
\end_inset

.
 Similarly each 
\begin_inset Formula $\left|X_{\bi}\right|\sim\left|Y_{\bi}\right|\sim\psi s_{\bi}n$
\end_inset

, and each 
\begin_inset Formula $\left|X_{\bi,\bj}\right|=\left|Y_{\bi,\bj}\right|=\left|Z_{\bi,\bj}\right|\sim\psi s_{\bi}s_{\bj}n$
\end_inset

.
 If we condition on the sizes of each 
\begin_inset Formula $W_{\bi}$
\end_inset

, 
\begin_inset Formula $X_{\bi,\bj}$
\end_inset

, 
\begin_inset Formula $Y_{\bj,\bi}$
\end_inset

, each is a uniformly random subset of 
\begin_inset Formula $V_{\bi}$
\end_inset

 of its size.
\end_layout

\begin_layout Standard
Here and in future parts of the proof, it is critical that these kinds of
 random subsets of our super-regular pairs maintain super-regularity (albeit
 with slightly weaker 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\delta$
\end_inset

).
 We will ensure this by appealing to the following lemma.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:random-preserves-superregular"

\end_inset

Fix 
\begin_inset Formula $\delta,\varepsilon>0$
\end_inset

.
 Suppose 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-super-regular, let 
\begin_inset Formula $n_{\h}$
\end_inset

 satisfy 
\begin_inset Formula $\left|V^{\h}\right|\ge n_{\h}=\Omega$
\end_inset


\begin_inset Formula $\left(n\right)$
\end_inset

 (the implied constant can depend on 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\delta$
\end_inset

) and for each 
\begin_inset Formula $\h$
\end_inset

 let 
\begin_inset Formula $W^{\h}\subseteq V^{\h}$
\end_inset

 be a uniformly random subset of size 
\begin_inset Formula $n_{\h}$
\end_inset

.
 Then 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

 is a.a.s.
 
\begin_inset Formula $\left(2\sqrt{\varepsilon},\delta/2\right)$
\end_inset

-super-regular.
\end_layout

\begin_layout Standard
To prove 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:random-preserves-superregular"

\end_inset

 we will apply a bipartite version of Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma on the edges between 
\begin_inset Formula $V^{1}$
\end_inset

 and 
\begin_inset Formula $V^{2}$
\end_inset

.
 The following formulation can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "Tao05"

\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma, bipartite version
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "lem:szemeredi-regularity-bipartite"

\end_inset

For any 
\begin_inset Formula $\varepsilon>0$
\end_inset

, there is 
\begin_inset Formula $K=K\left(\varepsilon\right)$
\end_inset

 such that the following holds.
 For any bipartite graph 
\begin_inset Formula $\G$
\end_inset

 with bipartition 
\begin_inset Formula $V^{1}\cup V^{2}$
\end_inset

, there are partitions of each 
\begin_inset Formula $V^{\h}$
\end_inset

 into clusters 
\begin_inset Formula $V_{0}^{\h},V_{1}^{\h},\dots,V_{k}^{\h}$
\end_inset

 (
\begin_inset Formula $k\le K$
\end_inset

), such that the 
\begin_inset Quotes eld
\end_inset

exceptional clusters
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $V_{0}^{\h}$
\end_inset

 has size at most 
\begin_inset Formula $\varepsilon\left|V^{\h}\right|$
\end_inset

, the other clusters 
\begin_inset Formula $V_{i}^{\h}$
\end_inset

 in each part have equal size 
\begin_inset Formula $s_{\h}\left|V^{\h}\right|$
\end_inset

, and all but 
\begin_inset Formula $\varepsilon k_{1}k_{2}$
\end_inset

 of the pairs of non-exceptional clusters are 
\begin_inset Formula $\varepsilon$
\end_inset

-regular.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
We will also need a linear relaxation of the notion of an 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense pair.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:density-relaxation"

\end_inset

If 
\begin_inset Formula $\left(V^{1},V^{2}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-dense then for any functions 
\begin_inset Formula $\pi^{\h}:V^{\h}\to\left[0,1\right]$
\end_inset

, we have 
\begin_inset Formula 
\[
\sum_{v\in V^{1}}\sum_{u\in V^{2}}\pi^{1}\left(v\right)\pi^{2}\left(u\right)\one_{v\sim u}\ge\delta\sum_{v\in V^{1}}\pi^{1}\left(v\right)\sum_{u\in V^{2}}\pi^{2}\left(u\right)-\varepsilon\delta\left|V^{1}\right|\left|V^{2}\right|.
\]

\end_inset


\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $f:\left[0,1\right]^{V^{1}\times V^{2}}\to\RR$
\end_inset

 be defined by
\begin_inset Formula 
\[
f\left(\pi\right)=\sum_{v\in V^{1}}\sum_{u\in V^{2}}\pi^{1}\left(v\right)\pi^{2}\left(u\right)\one_{v\sim u}-\delta\sum_{v\in V^{1}}\pi^{1}\left(v\right)\sum_{u\in V^{2}}\pi^{2}\left(u\right)
\]

\end_inset

Note that 
\begin_inset Formula $f$
\end_inset

 is linear in each 
\begin_inset Formula $\pi^{\h}$
\end_inset

 so it attains its extrema at vertices of the hypercube 
\begin_inset Formula $\left[0,1\right]^{V^{1}\times V^{2}}$
\end_inset

.
 But if each 
\begin_inset Formula $\pi^{\h}\left(v\right)\in\left[0,1\right]$
\end_inset

 then 
\begin_inset Formula $\pi^{1}$
\end_inset

 and 
\begin_inset Formula $\pi^{2}$
\end_inset

 just correspond to subsets 
\begin_inset Formula $U^{\h}\subseteq V^{\h}$
\end_inset

.
 We just need to show that 
\begin_inset Formula $f\left(\pi\right)\ge-\varepsilon\delta\left|V^{1}\right|\left|V^{2}\right|$
\end_inset

 for each such 
\begin_inset Formula $\pi$
\end_inset

.
 If each 
\begin_inset Formula $\left|U^{\h}\right|\ge\varepsilon\left|V^{\h}\right|$
\end_inset

 then 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-density implies 
\begin_inset Formula $f\left(\pi\right)=\varepsilon\left|U^{1}\right|\left|U^{2}\right|-\delta\left|U^{1}\right|\left|U^{2}\right|\ge0$
\end_inset

.
 Otherwise 
\begin_inset Formula $\left|U^{1}\right|\left|U^{2}\right|\le\varepsilon\left|V^{1}\right|\left|V^{2}\right|$
\end_inset

 so trivially 
\begin_inset Formula $f\left(\pi\right)\ge-\varepsilon\delta\left|V^{1}\right|\left|V^{2}\right|$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:random-preserves-superregular"

\end_inset


\end_layout

\end_inset

First, note that for each 
\begin_inset Formula $v\in W^{\h}$
\end_inset

, the number of neighbours of 
\begin_inset Formula $v\in W^{\flip{\h}}$
\end_inset

 is hypergeometrically distributed, with expected value at least 
\begin_inset Formula $\delta n_{\flip{\h}}$
\end_inset

.
 Since 
\begin_inset Formula $n_{\flip h}=\Omega\left(n\right)$
\end_inset

, a concentration inequality and the union bound immediately tells us that
 a.a.s.
 each such 
\begin_inset Formula $v$
\end_inset

 has 
\begin_inset Formula $\delta n_{\flip h}/2$
\end_inset

 such neighbours.
\end_layout

\begin_layout Proof
It remains to show that 
\begin_inset Formula $\left(W^{1},W^{2}\right)$
\end_inset

 is a.a.s.
 
\begin_inset Formula $\left(2\sqrt{\varepsilon},\delta/2\right)$
\end_inset

-dense.
 Apply 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:szemeredi-regularity-bipartite"

\end_inset

 to the bipartite graph between 
\begin_inset Formula $V^{1}$
\end_inset

 and 
\begin_inset Formula $V^{2}$
\end_inset

, with some regularity parameter 
\begin_inset Formula $\varepsilon'$
\end_inset

 to be determined.
 By a concentration inequality, a.a.s.
 for all 
\begin_inset Formula $i\ge1$
\end_inset

 we have 
\begin_inset Formula $\left|W^{\h}\cap V_{i}^{\h}\right|\le\left(1+\gamma\right)s_{\h}n_{\h}$
\end_inset

 for some 
\begin_inset Formula $\gamma\to0$
\end_inset

.
 Now, consider any 
\begin_inset Formula $U^{\h}\subseteq W^{\h}$
\end_inset

 with 
\begin_inset Formula $\left|U^{\h}\right|\ge2\sqrt{\varepsilon}n_{\h}$
\end_inset

, and let 
\begin_inset Formula $U_{i}^{\h}=U^{\h}\cap V_{i}^{\h}$
\end_inset

.
 Let 
\begin_inset Formula $I^{\h}=\left\{ i\ge1:\left|U_{i}^{\h}\right|\ge\varepsilon'\left|V_{i}^{\h}\right|\right\} $
\end_inset

 be the set of cluster indices with non-negligible intersection with 
\begin_inset Formula $U^{\h}$
\end_inset

.
 We have
\begin_inset Formula 
\begin{align*}
e\left(U^{1},U^{2}\right) & \ge\sum_{i\in I^{1}}\sum_{j\in I^{2}}d\left(U_{i}^{1},U_{j}^{2}\right)\left|U_{i}^{1}\right|\left|U_{j}^{2}\right|\\
 & \ge\sum_{i\in I^{1}}\sum_{j\in I^{2}}\left(d\left(V_{i}^{1},V_{j}^{2}\right)-\varepsilon'\right)\left|U_{i}^{1}\right|\left|U_{j}^{2}\right|-k^{2}\varepsilon'\left(\left(1+\gamma\right)s_{1}n_{1}\right)\left(\left(1+\gamma\right)s_{2}n_{2}\right)\\
 & \ge\sum_{i\in I^{1}}\sum_{j\in I^{2}}d\left(V_{i}^{1},V_{j}^{2}\right)\left|U^{1}\right|\left|U^{2}\right|-\varepsilon'\left|U^{1}\right|\left|U^{2}\right|-\varepsilon'n_{1}n_{2}-o\left(n^{2}\right)\\
 & \ge\sum_{i=1}^{k}\sum_{j=1}^{k}d\left(V_{i}^{1},V_{j}^{2}\right)\left|U_{i}^{1}\right|\left|U_{j}^{2}\right|-\varepsilon'\left|V^{1}\right|\left|V^{2}\right|-\varepsilon'\left|U^{1}\right|\left|U^{2}\right|-\varepsilon'n_{1}n_{2}-o\left(n^{2}\right).
\end{align*}

\end_inset

Now, we define 
\begin_inset Formula $\pi^{1},\pi^{2}$
\end_inset

 as follows.
 If 
\begin_inset Formula $v$
\end_inset

 is in some exceptional cluster 
\begin_inset Formula $V_{0}^{\h}$
\end_inset

 then let 
\begin_inset Formula $\pi^{\h}\left(v\right)=0$
\end_inset

.
 Otherwise if 
\begin_inset Formula $v\in V_{i}^{\h}$
\end_inset

 let 
\begin_inset Formula $\pi^{\h}\left(v\right)=\left|U_{i}^{\h}\right|/\left(\left(1+\gamma\right)s_{1}n_{1}\right)\in\left[0,1\right]$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:density-relaxation"

\end_inset

, 
\begin_inset Formula 
\begin{align*}
\sum_{i=1}^{k}\sum_{j=1}^{k}d\left(V_{i}^{1},V_{j}^{2}\right)\left|U_{i}^{1}\right|\left|U_{j}^{2}\right| & \ge\left(\frac{\left(1+\gamma\right)n_{1}}{\left|V^{1}\right|}\right)\left(\frac{\left(1+\gamma\right)n_{2}}{\left|V^{2}\right|}\right)\sum_{v\in V^{1}}\sum_{u\in V^{2}}\pi^{1}\left(v\right)\pi^{2}\left(u\right)\one_{v\sim u}\\
 & \ge\left(\frac{\left(1+\gamma\right)n_{1}}{\left|V^{1}\right|}\right)\left(\frac{\left(1+\gamma\right)n_{2}}{\left|V^{2}\right|}\right)\left(\delta\sum_{v\in V^{1}}\pi^{1}\left(v\right)\sum_{u\in V^{2}}\pi^{2}\left(u\right)-\varepsilon\delta\left|V^{1}\right|\left|V^{2}\right|\right)\\
 & \ge\delta\left(\left|U^{1}\right|-\varepsilon'\left|V^{1}\right|\right)\left(\left|U^{2}\right|-\varepsilon'\left|V^{2}\right|\right)-\left(1+\gamma\right)^{2}n_{1}n_{2}\varepsilon\delta\\
 & \ge\delta\left|U^{1}\right|\left|U^{2}\right|-3\varepsilon'\left|V^{1}\right|\left|V^{2}\right|-\varepsilon\delta n_{1}n_{2}-o\left(n^{2}\right).
\end{align*}

\end_inset

It follows that 
\begin_inset Formula 
\[
e\left(U^{1},U^{2}\right)\ge\delta\left|U^{1}\right|\left|U^{2}\right|-6\varepsilon'\left|V^{1}\right|\left|V^{2}\right|-\left(\delta/4\right)\left|U^{1}\right|\left|U^{2}\right|-o\left(n^{2}\right).
\]

\end_inset

Let 
\begin_inset Formula $\varepsilon'=\varepsilon\delta n_{1}n_{2}/\left(6\left|V^{1}\right|\left|V^{2}\right|\right)$
\end_inset

, so that 
\begin_inset Formula $e\left(U^{1},U^{2}\right)\ge\left(\delta/2\right)\left|U^{1}\right|\left|U^{2}\right|$
\end_inset

 as required.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\flip{\left(i,\h\right)}=\left(i,\flip{\h}\right)$
\end_inset

.
 It is an immediate consequence of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:random-preserves-superregular"

\end_inset

 that each of 
\begin_inset Formula $\left(X_{\bi,\bj},W_{\flip{\bi}}\right)$
\end_inset

, 
\begin_inset Formula $\left(W_{\bi},W_{\flip{\bi}}\right)$
\end_inset

 and 
\begin_inset Formula $\left(W_{\bi},Y_{\bj,\flip{\bi}}\right)$
\end_inset

 are 
\begin_inset Formula $\left(\varepsilon',\delta'\right)$
\end_inset

-super-regular, where 
\begin_inset Formula $\varepsilon'=2\sqrt{\varepsilon}$
\end_inset

 and 
\begin_inset Formula $\delta'=\delta/2$
\end_inset

.
\end_layout

\begin_layout Standard
Now that we have embedded 
\begin_inset Formula $\F$
\end_inset

, we no longer care about the vertices used to embed 
\begin_inset Formula $\F\backslash\left(X\cup Y\right)$
\end_inset

; they will never be used again.
 It is convenient to imagine, for the duration of the proof, that instead
 of embedding parts of 
\begin_inset Formula $\T$
\end_inset

, we are 
\begin_inset Quotes eld
\end_inset

removing
\begin_inset Quotes erd
\end_inset

 vertices from 
\begin_inset Formula $\G\cup\R$
\end_inset

, gradually making the remaining graph easier to deal with.
 So, remove from each 
\begin_inset Formula $V_{\bi}$
\end_inset

 all vertices used in 
\begin_inset Formula $\F\backslash\left(X\cup Y\right)$
\end_inset

.
 Update 
\begin_inset Formula $n$
\end_inset

 to be the number of vertices not used to embed 
\begin_inset Formula $\F\backslash\left(X\cup Y\right)$
\end_inset

 (previously 
\begin_inset Formula $\left(1/2+2\psi\right)n$
\end_inset

), and update each 
\begin_inset Formula $s_{\bi}$
\end_inset

 to still satisfy 
\begin_inset Formula $s_{\bi}n=\left|V_{\bi}\right|$
\end_inset

 (this does not change 
\begin_inset Formula $s_{\bi}$
\end_inset

 asymptotically).
 We now have 
\begin_inset Formula 
\[
\left|Z_{\bi,\bj}\right|\sim\psi s_{\bi}s_{\bj}n/\left(1/2+2\psi\right)=s_{\bi}s_{\bj}n/\left(k+1\right).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Embedding special paths not compatible with the super-regular partition
\begin_inset CommandInset label
LatexCommand label
name "sub:embed-paths-between"

\end_inset


\end_layout

\begin_layout Standard
Next, we want to eliminate almost all special pairs which are not between
 clusters of a super-regular pair.
 This is achieved using the following lemma (which will be used again later).
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:adjusting-paths"

\end_inset

For any 
\begin_inset Formula $\delta>0$
\end_inset

, 
\begin_inset Formula $f<1$
\end_inset

, 
\begin_inset Formula $\xi>0$
\end_inset

, and any integer 
\begin_inset Formula $k>2$
\end_inset

 there is 
\begin_inset Formula $\c=\c\left(\delta,\xi,k\right)$
\end_inset

 such that the following holds.
\end_layout

\begin_layout Lemma
Let 
\begin_inset Formula $\G$
\end_inset

 be a graph on some vertex set 
\begin_inset Formula $\range N$
\end_inset

, together with a vertex partition into clusters.
 Consider any sequence of clusters 
\begin_inset Formula $X,V_{1},\dots,V_{r},Y$
\end_inset

, and any integer partition 
\begin_inset Formula $t_{1}+\dots+t_{r}=k-1$
\end_inset

 (each 
\begin_inset Formula $t_{i}\in\NN^{+}$
\end_inset

), such that 
\begin_inset Formula $\left|V_{i}\right|\ge t_{i}n$
\end_inset

 and 
\begin_inset Formula $\left|X\right|,\left|Y\right|=n$
\end_inset

.
 Suppose that each 
\begin_inset Formula $x\in X$
\end_inset

 (respectively, 
\begin_inset Formula $y\in Y$
\end_inset

) has at least 
\begin_inset Formula $\delta\left|V_{1}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $V_{1}$
\end_inset

 (respectively, 
\begin_inset Formula $\delta\left|V_{r}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $V_{r}$
\end_inset

).
\end_layout

\begin_layout Lemma
Suppose further that each 
\begin_inset Formula $\x\in X$
\end_inset

 is bijectively paired with a vertex 
\begin_inset Formula $\y\in Y$
\end_inset

, comprising a special pair 
\begin_inset Formula $\left(\x,\y\right)$
\end_inset

.
 Let 
\begin_inset Formula $\R\in\GG\left(N,\c/N\right)$
\end_inset

.
 Then, in 
\begin_inset Formula $\G\cup\R$
\end_inset

 we can find 
\begin_inset Formula $\left(1-\xi\right)n$
\end_inset

 vertex-disjoint special paths, each with 
\begin_inset Formula $t_{i}$
\end_inset

 vertices in each 
\begin_inset Formula $V_{i}$
\end_inset

.
 These paths depend on 
\begin_inset Formula $\R$
\end_inset

 so are random; in fact we can assume that the vertices used in each 
\begin_inset Formula $V_{i}$
\end_inset

, 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independently uniformly random subsets of their respective sizes.
\end_layout

\begin_layout Proof
Uniformly at random choose 
\begin_inset Formula $t_{i}$
\end_inset

 disjoint 
\begin_inset Formula $n$
\end_inset

-vertex subsets of each 
\begin_inset Formula $V_{i}$
\end_inset

.
 This gives a total of 
\begin_inset Formula $k-1$
\end_inset

 such subsets; arrange these into a sequence 
\begin_inset Formula $W_{1},\dots,W_{k-1}$
\end_inset

 in such a way that 
\begin_inset Formula $W_{1}\subseteq V_{1}$
\end_inset

 and 
\begin_inset Formula $W_{k-1}\subseteq V_{r}$
\end_inset

.
 By concentration and the union bound, for 
\begin_inset Formula $\delta_{1}=\delta/2$
\end_inset

 each 
\begin_inset Formula $x\in X$
\end_inset

 (respectively, 
\begin_inset Formula $y\in Y$
\end_inset

) has at least 
\begin_inset Formula $\delta_{1}\left|W_{1}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $W_{1}$
\end_inset

 (respectively, 
\begin_inset Formula $\delta_{1}\left|V_{k-1}\right|$
\end_inset

 neighbours in 
\begin_inset Formula $W_{k-1}$
\end_inset

).
 To summarize these minimum degree conditions, we say that the situation
 is 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\delta_{1}$
\end_inset

-good
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Proof
Now, break 
\begin_inset Formula $\R$
\end_inset

 into phases 
\begin_inset Formula $\R\supseteq\R_{1}\cup\dots\cup\R_{r}$
\end_inset

, for some large 
\begin_inset Formula $r=r\left(\delta\right)$
\end_inset

 to be determined.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-matching"

\end_inset

, in 
\begin_inset Formula $\R_{1}$
\end_inset

 we can find a matching of 
\begin_inset Formula $\left(1-1/\left(2\left(k-2\right)\right)\right)n$
\end_inset

 edges between each 
\begin_inset Formula $W_{i}$
\end_inset

 and 
\begin_inset Formula $W_{i+1}$
\end_inset

 (
\begin_inset Formula $1\le i<k-1$
\end_inset

).
 This gives us a disjoint union of 
\begin_inset Formula $n/2$
\end_inset

 length-
\begin_inset Formula $\left(k-2\right)$
\end_inset

 paths 
\begin_inset Formula $P_{1},\dots,P_{n/2}$
\end_inset

; we write 
\begin_inset Formula $P_{i}=v_{1}^{i}\dots v_{k-1}^{i}$
\end_inset

 with 
\begin_inset Formula $v_{j}^{i}\in V_{j}$
\end_inset

.
 For each 
\begin_inset Formula $j$
\end_inset

, we can assume that 
\begin_inset Formula $v_{j}^{1},\dots,v_{j}^{n/2}$
\end_inset

 is a uniformly random ordering of a uniformly random set of 
\begin_inset Formula $n/2$
\end_inset

 elements of 
\begin_inset Formula $W_{j},$
\end_inset

which we can complete into a uniformly random ordering 
\begin_inset Formula $v_{j}^{1},\dots,v_{j}^{n}$
\end_inset

 (independently for 
\begin_inset Formula $1\le j\le k-1$
\end_inset

).
 Now, let the special pairs be 
\begin_inset Formula $\left(\x^{1},\y^{1}\right),\dots,\left(\x^{n},\y^{n}\right)$
\end_inset

.
 Let 
\begin_inset Formula $I_{X}$
\end_inset

 (respectively 
\begin_inset Formula $I_{Y}$
\end_inset

) be the set of indices 
\begin_inset Formula $i\le n/2$
\end_inset

 such that 
\begin_inset Formula $v_{1}^{i}$
\end_inset

 is adjacent to 
\begin_inset Formula $\x^{i}$
\end_inset

 (respectively, 
\begin_inset Formula $v_{k-1}^{i}$
\end_inset

 is adjacent to 
\begin_inset Formula $\y^{i}$
\end_inset

).
 By linearity of expectation, 
\begin_inset Formula $\E\left|I_{X}\right|,\E\left|I_{Y}\right|\ge\left(\delta_{1}/2\right)n$
\end_inset

.
 If we vary the ordering 
\begin_inset Formula $v_{1}^{1},\dots,v_{1}^{n}$
\end_inset

 (respectively 
\begin_inset Formula $v_{k-1}^{1},\dots,v_{k-1}^{n}$
\end_inset

) by a transposition, this changes 
\begin_inset Formula $\left|I_{X}\right|$
\end_inset

 (respectively 
\begin_inset Formula $\left|I_{Y}\right|$
\end_inset

) by at most 2.
 So, by a bounded-differences concentration inequality (for example 
\begin_inset CommandInset citation
LatexCommand cite
after "Lemma~B.1"
key "FP04"

\end_inset

), a.a.s.
 we have 
\begin_inset Formula $\left|I_{X}\right|,\left|I_{Y}\right|\ge\left(\delta_{1}/3\right)n$
\end_inset

.
 Conditioning on 
\begin_inset Formula $I_{X}$
\end_inset

 and 
\begin_inset Formula $\left|I_{Y}\right|$
\end_inset

, a concentration inequality for the hypergeometric distribution shows that
 a.a.s.
 
\begin_inset Formula $\left|I_{X}\cap I_{Y}\right|\ge\gamma\left(\delta_{1}\right)n$
\end_inset

, where 
\begin_inset Formula $\gamma\left(\delta_{1}\right)=\delta_{1}^{2}/10$
\end_inset

.
 The indices in 
\begin_inset Formula $I_{X}\cap I_{Y}$
\end_inset

 correspond to 
\begin_inset Formula $\gamma\left(\delta_{1}\right)n$
\end_inset

 special paths 
\begin_inset Formula $\x^{i},v_{1}^{i},\dots,v_{k-1}^{i},\y^{i}$
\end_inset

.
\end_layout

\begin_layout Proof
Remove these special paths and and their vertices in 
\begin_inset Formula $W_{i}$
\end_inset

.
 Let 
\begin_inset Formula $\delta_{i}=\delta_{1}/\left(1+\left(i-1\right)/r\right)$
\end_inset

; by concentration and the union bound the situation is still a.a.s.
 
\begin_inset Formula $\delta_{2}$
\end_inset

-good after these removals.
 We can therefore repeat the previous argument using 
\begin_inset Formula $\R_{2}$
\end_inset

 to find more special paths.
 After repeating the argument all 
\begin_inset Formula $r$
\end_inset

 times (before iteration 
\begin_inset Formula $i$
\end_inset

 we are 
\begin_inset Formula $\delta_{i}$
\end_inset

-good), there are at most 
\begin_inset Formula 
\[
n\prod_{i=0}^{r-1}\left(1-\gamma\left(\delta_{i}\right)\right)\le\left(1-\gamma\left(\delta/4\right)\right)^{r}n
\]

\end_inset

vertices remaining in 
\begin_inset Formula $X$
\end_inset

 and in 
\begin_inset Formula $Y$
\end_inset

.
 If we choose large enough 
\begin_inset Formula $r$
\end_inset

 this is fewer than 
\begin_inset Formula $\xi n$
\end_inset

 remaining vertices, as required.
\end_layout

\begin_layout Standard
Now we return to the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:main-theorem"

\end_inset

.
 For each 
\begin_inset Formula $\bi,\bj$
\end_inset

 with 
\begin_inset Formula $\bj\ne\flip{\bi}$
\end_inset

, and some very small 
\begin_inset Formula $\xi=\xi\left(a,\delta\right)>0$
\end_inset

, we want to find 
\begin_inset Formula $\left(1-\xi\right)s_{\bi}s_{\bj}n/\left(k+1\right)$
\end_inset

 special paths connecting special pairs in 
\begin_inset Formula $Z_{\bi,\bj}$
\end_inset

, in such a way that each of these special paths has one interior vertex
 from 
\begin_inset Formula $W_{\flip{\bi}}$
\end_inset

, one interior vertex from 
\begin_inset Formula $W_{\flip{\bj}}$
\end_inset

 and the other 
\begin_inset Formula $k-3$
\end_inset

 interior vertices from 
\begin_inset Formula $W_{\bi}$
\end_inset

.
 Provided 
\begin_inset Formula $k$
\end_inset

 is large we can find our desired paths with at most 
\begin_inset Formula $\left(2q\right)^{2}$
\end_inset

 applications of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

.
 To be precise, as in the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

, we split 
\begin_inset Formula $\R_{2}$
\end_inset

 into 
\begin_inset Formula $\left(2q\right)^{2}$
\end_inset

 phases and use 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

 to remove paths in each phase sequentially.
 By concentration and the union bound, after each phase we still have a
 suitable minimum degree condition for this to be possible.
\end_layout

\begin_layout Standard
As well as removing these paths, remove their corresponding vertices from
 
\begin_inset Formula $V_{\bi},W_{\bi},X_{\bi},Y_{\bi}X_{\bi,\bj},Y_{\bi,\bj},Z_{\bi,\bj}$
\end_inset

.
 We have removed a uniformly random subset of a certain size from each 
\begin_inset Formula $V_{\bi},W_{\bi},X_{\bi,\bj},Y_{\bi,\bj}$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:random-preserves-superregular"

\end_inset

, each 
\begin_inset Formula $\left(X_{\bi,\bj},W_{\flip{\bi}}\right)$
\end_inset

, 
\begin_inset Formula $\left(W_{\bi},W_{\flip{\bi}}\right)$
\end_inset

 and 
\begin_inset Formula $\left(W_{\bi},Y_{\bj,\flip{\bi}}\right)$
\end_inset

 are 
\begin_inset Formula $\left(\varepsilon'',\delta''\right)$
\end_inset

-super-regular, where 
\begin_inset Formula $\varepsilon''=2\sqrt{\varepsilon'}$
\end_inset

 and 
\begin_inset Formula $\delta''=\delta'/2$
\end_inset

.
 Let 
\begin_inset Formula $a'=a'\left(a\right)$
\end_inset

 satisfy 
\begin_inset Formula $\left|W_{\bi}\right|\ge a'n$
\end_inset

 (for large 
\begin_inset Formula $k$
\end_inset

, 
\begin_inset Formula $a'=a^{2}/2$
\end_inset

 will do).
\end_layout

\begin_layout Standard
Now, for every 
\begin_inset Formula $\bi,\bj$
\end_inset

 with 
\begin_inset Formula $\bj\ne\flip{\bi}$
\end_inset

, we have 
\begin_inset Formula $\left|Z_{\bi,\bj}\right|=\xi s_{\bi}s_{\bj}n/\left(k+1\right)$
\end_inset

.
 The special pairs in all such 
\begin_inset Formula $Z_{\bi,\bj}$
\end_inset

 comprise a total of at most 
\begin_inset Formula $\xi n/\left(k+1\right)$
\end_inset

 
\begin_inset Quotes eld
\end_inset

bad
\begin_inset Quotes erd
\end_inset

 special pairs.
 For small 
\begin_inset Formula $\xi$
\end_inset

 this is less than  
\begin_inset Formula $\delta'a'n/\left(2\left(k+1\right)\right)$
\end_inset

 special pairs, which we deal with greedily, as follows.
 For some such special pair 
\begin_inset Formula $\left(\x,\y\right)$
\end_inset

 with 
\begin_inset Formula $\x\in X_{\bi}$
\end_inset

 and 
\begin_inset Formula $\y\in Y_{\bj}$
\end_inset

, choose a length-
\begin_inset Formula $\left(k-3\right)$
\end_inset

 path 
\begin_inset Formula $\x w_{1},\dots,w_{k-3}$
\end_inset

 in 
\begin_inset Formula $\G$
\end_inset

, where the 
\begin_inset Formula $w_{\ell}$
\end_inset

 alternate between 
\begin_inset Formula $W_{\bi}$
\end_inset

 and 
\begin_inset Formula $W_{\flip{\bi}}$
\end_inset

 with 
\begin_inset Formula $w_{k-3}\in W_{\bi}$
\end_inset

 (recall, 
\begin_inset Formula $k$
\end_inset

 is odd).
 Then choose a set 
\begin_inset Formula $U_{x}\subseteq W_{\flip{\bi}}$
\end_inset

 of 
\begin_inset Formula $\delta'a'n/4$
\end_inset

 neighbours of 
\begin_inset Formula $w_{k-3}$
\end_inset

 and a disjoint set 
\begin_inset Formula $U_{y}\subseteq W_{\flip{\bj}}$
\end_inset

 of 
\begin_inset Formula $\delta'a'n/4$
\end_inset

 neighbours of 
\begin_inset Formula $\y$
\end_inset

.
 Now, note that (if 
\begin_inset Formula $\c_{3}$
\end_inset

 is large), there is a.a.s.
 an edge in 
\begin_inset Formula $\R_{3}$
\end_inset

 between any pair of disjoint sets of size 
\begin_inset Formula $\delta'a'n/4$
\end_inset

 (the proof of this is basically identical to the proof of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:bipartite-matching"

\end_inset

).
 Such an edge allows us to complete a special path from 
\begin_inset Formula $\x$
\end_inset

 to 
\begin_inset Formula $\y$
\end_inset

, which we remove.
 We can repeat this for each unconnected bad special pair.
 Note that these special paths comprise less than 
\begin_inset Formula $\delta'a'n/2$
\end_inset

 vertices total, which is so few that each 
\begin_inset Formula $\left(W_{\bi},W_{\flip{\bi}}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta'/2\right)$
\end_inset

-super-regular, and each 
\begin_inset Formula $\x\in X_{\bi}$
\end_inset

 (respectively 
\begin_inset Formula $\y\in Y_{\bi}$
\end_inset

) has at least 
\begin_inset Formula $\delta a'n/2$
\end_inset

 neighbours in 
\begin_inset Formula $W_{\flip{\bi}}$
\end_inset

, throughout the whole process.
\end_layout

\begin_layout Standard
Now, update all the relevant variables.
 We are left with a set of clusters 
\begin_inset Formula $X_{\bi},W_{\bi},Y_{\bi}$
\end_inset

 partitioning the vertices of 
\begin_inset Formula $\G\cup\R$
\end_inset

, such that each 
\begin_inset Formula $\left(X_{\bi},W_{\flip{\bi}}\right)$
\end_inset

, 
\begin_inset Formula $\left(W_{\bi},W_{\flip{\bi}}\right)$
\end_inset

 and 
\begin_inset Formula $\left(W_{\bi},Y_{\flip{\bi}}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta'/2\right)$
\end_inset

-regular, and each special pair is in some 
\begin_inset Formula $X_{\bi}\times Y_{\flip{\bi}}$
\end_inset

.
 Moreover, with 
\begin_inset Formula $X$
\end_inset

 (respectively 
\begin_inset Formula $Y$
\end_inset

) being the set of 
\begin_inset Formula $\x$
\end_inset

-type (respectively 
\begin_inset Formula $\y$
\end_inset

-type) vertices remaining, and 
\begin_inset Formula $W$
\end_inset

 being the set of non-special vertices remaining, we have 
\begin_inset Formula $\left(k-1\right)\left|X\right|=\left(k-1\right)\left|Y\right|=\left|W\right|$
\end_inset

.
 For large 
\begin_inset Formula $k$
\end_inset

 each 
\begin_inset Formula $a''n\le\left|X_{\bi}\right|,\left|Y_{\bi}\right|,\left|W_{\bi}\right|\le b''n$
\end_inset

 for some 
\begin_inset Formula $a'',b''>0$
\end_inset

, and each 
\begin_inset Formula $\left|X_{\bi}\right|,\left|Y_{\bi}\right|\le\left|W_{\bj}\right|$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Adjusting the relative sizes of the clusters
\begin_inset CommandInset label
LatexCommand label
name "sub:embed-relative-sizes"

\end_inset


\end_layout

\begin_layout Standard
The next step is to remove paths such that in the graph that remains, we
 have 
\begin_inset Formula $\left|W_{\bi}\right|=\left(k-1\right)\left|X_{\bi}\cup Y_{\bi}\right|/2$
\end_inset

 for each 
\begin_inset Formula $\bi$
\end_inset

.
 This is easily achievable through repeated application of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

, but is a bit fiddly to explain.
\end_layout

\begin_layout Standard
Suppose 
\begin_inset Formula $\left(k-1\right)\left|X_{\bi}\cup Y_{\bi}\right|/2+m\ge\left|W_{\bi}\right|$
\end_inset

 and 
\begin_inset Formula $\left(k-1\right)\left|X_{\bj}\cup Y_{\bj}\right|/2+m\le\left|W_{\bj}\right|$
\end_inset

 for some 
\begin_inset Formula $m>0$
\end_inset

, where one of these inequalities is an equality.
 Use 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

 and 
\begin_inset Formula $\R_{4}$
\end_inset

 to find 
\begin_inset Formula $\floor{m/\left(\left(k-1\right)/2-1\right)}$
\end_inset

 special paths connecting special pairs in 
\begin_inset Formula $X_{\bi}\times Y_{\flip{\bi}}$
\end_inset

, each with 
\begin_inset Formula $\left(k-1\right)/2$
\end_inset

 interior vertices in 
\begin_inset Formula $W_{\flip{\bi}}$
\end_inset

, one interior vertex in 
\begin_inset Formula $W_{\bi}$
\end_inset

, and the remaining 
\begin_inset Formula $\left(k-1\right)/2-1$
\end_inset

 interior vertices in 
\begin_inset Formula $W_{\bj}$
\end_inset

.
\end_layout

\begin_layout Standard
Then, let 
\begin_inset Formula 
\[
r=\left(\left(k-1\right)/2-1\right)\left\langle \frac{m}{\left(k-1\right)/2-1}\right\rangle ,
\]

\end_inset

where 
\begin_inset Formula $\left\langle \cdot\right\rangle $
\end_inset

 denotes the fractional part of a real number.
 With another application of 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:adjusting-paths"

\end_inset

, find a single special path connecting a special pair in 
\begin_inset Formula $X_{\bi}\times Y_{\flip{\bi}}$
\end_inset

, which has 
\begin_inset Formula $\left(k-1\right)/2$
\end_inset

 interior vertices in 
\begin_inset Formula $W_{\flip{\bi}}$
\end_inset

, has 
\begin_inset Formula $\left(k-1\right)/2-r$
\end_inset

 interior vertices in 
\begin_inset Formula $W_{\bi}$
\end_inset

, and has 
\begin_inset Formula $r$
\end_inset

 interior vertices in 
\begin_inset Formula $W_{\bj}$
\end_inset

.
 We now have either 
\begin_inset Formula $\left(k-1\right)\left|X_{\bi}\cup Y_{\bi}\right|/2=\left|W_{\bi}\right|$
\end_inset

 or 
\begin_inset Formula $\left(k-1\right)\left|X_{\bj}\cup Y_{\bj}\right|/2=\left|W_{\bj}\right|$
\end_inset

.
 After at most 
\begin_inset Formula $2q$
\end_inset

 iterations of this argument, we will have each 
\begin_inset Formula $\left(k-1\right)\left|X_{\bi}\cup Y_{\bi}\right|/2=\left|W_{\bi}\right|$
\end_inset

 as desired.
 Each 
\begin_inset Formula $\left(X_{\bi},W_{\flip{\bi}}\right)$
\end_inset

, 
\begin_inset Formula $\left(W_{\bi},W_{\flip{\bi}}\right)$
\end_inset

 and 
\begin_inset Formula $\left(W_{\bi},Y_{\flip{\bi}}\right)$
\end_inset

 is now 
\begin_inset Formula $\left(\varepsilon''',\delta'''\right)$
\end_inset

-super-regular, where 
\begin_inset Formula $\varepsilon'''=2\sqrt{\varepsilon''}$
\end_inset

 and 
\begin_inset Formula $\delta'''=\delta''/4$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Completing the embedding with the blow-up lemma
\begin_inset CommandInset label
LatexCommand label
name "sub:blow-up"

\end_inset


\end_layout

\begin_layout Standard
We have now finished with the edges in 
\begin_inset Formula $\R$
\end_inset

; what remains is sufficiently well-structured that we can embed the remaining
 paths using the blow-up lemma and the super-regularity in 
\begin_inset Formula $\G$
\end_inset

.
 The idea is illustrated in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cluster-paths"

\end_inset

.
 We first give a statement of the blow-up lemma.
\end_layout

\begin_layout Lemma
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Blow-up Lemma 
\begin_inset CommandInset citation
LatexCommand cite
key "KSS97"

\end_inset


\end_layout

\end_inset

Let 
\begin_inset Formula $\delta,\Delta>0$
\end_inset

 and 
\begin_inset Formula $r\in\NN$
\end_inset

.
 There is 
\begin_inset Formula $\varepsilon=\varepsilon\left(r,\delta,\Delta\right)$
\end_inset

 such that the following holds.
 Let 
\begin_inset Formula $C$
\end_inset

 be a graph on the vertex set 
\begin_inset Formula $\range r$
\end_inset

, and let 
\begin_inset Formula $n_{1},\dots,n_{r}$
\end_inset

 be arbitrary positive integers.
 Let 
\begin_inset Formula $V_{1},\dots,V_{r}$
\end_inset

 be pairwise disjoint sets of sizes 
\begin_inset Formula $n_{1},\dots,n_{r}$
\end_inset

.
 We construct two graphs on the vertex set 
\begin_inset Formula $V=\bigcup_{i=1}^{r}V_{i}$
\end_inset

 as follows.
 The first graph 
\begin_inset Formula $b\left(C\right)$
\end_inset

 (the 
\begin_inset Quotes eld
\end_inset

complete blow-up
\begin_inset Quotes erd
\end_inset

) is obtained by putting the complete bipartite graph between 
\begin_inset Formula $V_{i}$
\end_inset

 and 
\begin_inset Formula $V_{j}$
\end_inset

 whenever 
\begin_inset Formula $\left\{ i,j\right\} $
\end_inset

 is an edge in 
\begin_inset Formula $C$
\end_inset

.
 The second graph 
\begin_inset Formula $b_{\varepsilon,\delta}\left(C\right)$
\end_inset

 (a 
\begin_inset Quotes eld
\end_inset

super-regular blow-up
\begin_inset Quotes erd
\end_inset

) is obtained by putting edges between each such 
\begin_inset Formula $V_{i}$
\end_inset

 and 
\begin_inset Formula $V_{j}$
\end_inset

 such that 
\begin_inset Formula $\left(V_{i},V_{j}\right)$
\end_inset

 is an 
\begin_inset Formula $\left(\varepsilon,\delta\right)$
\end_inset

-super-regular pair.
 If a graph 
\begin_inset Formula $H$
\end_inset

 with maximum degree bounded by 
\begin_inset Formula $\Delta$
\end_inset

 can be embedded into 
\begin_inset Formula $b\left(C\right)$
\end_inset

, then it can be embedded into 
\begin_inset Formula $b_{\varepsilon,\delta}\left(C\right)$
\end_inset

.
\end_layout

\begin_layout Standard
Now we describe the setup to apply the blow-up lemma.
 Uniformly at random divide each 
\begin_inset Formula $W_{\bi}$
\end_inset

 into sets 
\begin_inset Formula $A_{\bi}$
\end_inset

 and 
\begin_inset Formula $B_{\bi}$
\end_inset

 of size 
\begin_inset Formula $\left(k-1\right)\left|X_{\bi}\right|/2$
\end_inset

 and 
\begin_inset Formula $\left(k-1\right)\left|Y_{\bi}\right|/2$
\end_inset

 respectively.
 For 
\begin_inset Formula $\bi=\left(i,\h\right)$
\end_inset

, let 
\begin_inset Formula $S_{\bi}^{0}=X_{\bi}$
\end_inset

, 
\begin_inset Formula $S_{\bi}^{1}=B_{\flip{\bi}}$
\end_inset

, 
\begin_inset Formula $S_{\bi}^{2}=A_{\bi}$
\end_inset

 and 
\begin_inset Formula $S_{\bi}^{3}=Y_{\flip{\bi}}$
\end_inset

, so that each 
\begin_inset Formula $\left(S_{\bi}^{0},S_{\bi}^{2},S_{\bi}^{3},S_{\bi}^{3}\right)$
\end_inset

 is a sequence of clusters of sizes 
\begin_inset Formula $n_{\bi},\left(k-1\right)n_{\bi}/2,\left(k-1\right)n_{\bi}/2,n_{\bi}$
\end_inset

 for some 
\begin_inset Formula $n_{\bi}$
\end_inset

, and each 
\begin_inset Formula $\left(S_{\bi}^{\ell},S_{\bi}^{\ell+1}\right)$
\end_inset

 is 
\begin_inset Formula $\left(\varepsilon,\delta''/2\right)$
\end_inset

-super-regular.
\end_layout

\begin_layout Standard
For each 
\begin_inset Formula $\bi$
\end_inset

, we construct an auxiliary graph 
\begin_inset Formula $G_{\bi}$
\end_inset

 as follows.
 Start with the subgraph of 
\begin_inset Formula $\G$
\end_inset

 induced by 
\begin_inset Formula $S_{\bi}^{0}\cup S_{\bi}^{2}\cup S_{\bi}^{3}\cup S_{\bi}^{3}$
\end_inset

, and remove every edge not between some 
\begin_inset Formula $S_{\bi}^{\ell}$
\end_inset

 and 
\begin_inset Formula $S_{\bi}^{\ell+1}$
\end_inset

.
 Contract each special pair to a single vertex, to obtain a super-regular
 
\begin_inset Quotes eld
\end_inset

cluster-cycle
\begin_inset Quotes erd
\end_inset

 with 3 clusters 
\begin_inset Formula $S_{\bi}^{*},S_{\bi}^{1},S_{\bi}^{2}$
\end_inset

 of sizes 
\begin_inset Formula $n_{\bi},\left(k-1\right)n_{\bi}/2,\left(k-1\right)n_{\bi}/2$
\end_inset

.
 This is a 
\begin_inset Formula $\left(\varepsilon,\delta''\right)$
\end_inset

-super-regular blow-up of a 3-cycle 
\begin_inset Formula $C_{3}$
\end_inset

.
\end_layout

\begin_layout Standard
The complete blow-up 
\begin_inset Formula $b\left(C_{3}\right)$
\end_inset

 contains 
\begin_inset Formula $n_{\bi}$
\end_inset

 disjoint 
\begin_inset Formula $k$
\end_inset

-cycles (each has a vertex in 
\begin_inset Formula $S_{\bi}^{*}$
\end_inset

 and its other 
\begin_inset Formula $k-1$
\end_inset

 vertices alternate between 
\begin_inset Formula $S_{\bi}^{1}$
\end_inset

 and 
\begin_inset Formula $S_{\bi}^{2}$
\end_inset

).
 By the blow-up lemma, for small 
\begin_inset Formula $\varepsilon$
\end_inset

 the 
\begin_inset Formula $\left(\varepsilon,\delta''\right)$
\end_inset

-super-regular blow-up 
\begin_inset Formula $G_{\bi}$
\end_inset

 of 
\begin_inset Formula $C_{3}$
\end_inset

 also contains 
\begin_inset Formula $n_{\bi}$
\end_inset

 disjoint 
\begin_inset Formula $k$
\end_inset

-cycles.
 Since 
\begin_inset Formula $k$
\end_inset

 is odd, each of these must use at least one vertex from 
\begin_inset Formula $S_{\bi}^{*}$
\end_inset

, but since 
\begin_inset Formula $\left|S_{\bi}^{*}\right|=n_{\bi}$
\end_inset

, each cycle must then use exactly one vertex from 
\begin_inset Formula $S_{\bi}^{*}$
\end_inset

.
 Each of these cycles corresponds to a special path running through 
\begin_inset Formula $S_{\bi}^{0},S_{\bi}^{2},S_{\bi}^{3},S_{\bi}^{3}$
\end_inset

, and these special paths complete our embedding of 
\begin_inset Formula $\T$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[scale=0.63]
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
y{0}
\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
h{1}
\end_layout

\begin_layout Plain Layout


\backslash
draw (0,
\backslash
y) -| (9,1+
\backslash
y) -| (8,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (8,1+
\backslash
y) -| (4,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (4,1+
\backslash
y) -| (2,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (2,1+
\backslash
y) -| (0,
\backslash
y);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (-0.7,0.5+
\backslash
y) {$V^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (1,0.5+
\backslash
y) {$X^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (3,0.5+
\backslash
y) {$B^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (6,0.5+
\backslash
y) {$A^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (8.5,0.5+
\backslash
y) {$Y^
\backslash
h$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
y{-7}
\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
h{2}
\end_layout

\begin_layout Plain Layout


\backslash
draw (0,
\backslash
y) -| (9,1+
\backslash
y) -| (7,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (7,1+
\backslash
y) -| (5,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (5,1+
\backslash
y) -| (1,
\backslash
y)
\end_layout

\begin_layout Plain Layout

      (1,1+
\backslash
y) -| (0,
\backslash
y);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (-0.7,0.5+
\backslash
y) {$V^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (0.5,0.5+
\backslash
y) {$X^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (3,0.5+
\backslash
y) {$B^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (6,0.5+
\backslash
y) {$A^
\backslash
h$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (8,0.5+
\backslash
y) {$Y^
\backslash
h$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (0.25,0) -- (1.75,0) -- (4.75,1+
\backslash
y) -- (1.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (2.25,0) -- (3.75,0) -- (0.75,1+
\backslash
y) -- (0.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (4.25,0) -- (7.75,0) -- (4.75,1+
\backslash
y) -- (1.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (2.25,0) -- (3.75,0) -- (6.75,1+
\backslash
y) -- (5.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (4.25,0) -- (7.75,0) -- (8.75,1+
\backslash
y) -- (7.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (8.25,0) -- (8.75,0) -- (6.75,1+
\backslash
y) -- (5.25,1+
\backslash
y) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
sqrt{1.41421356237}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
x{13}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
y{-3}
\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x,
\backslash
y-1) -| (
\backslash
x+2,
\backslash
y+1) -| cycle
\end_layout

\begin_layout Plain Layout

      (
\backslash
x,
\backslash
y) -- (
\backslash
x+2,
\backslash
y);
\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+2.5,
\backslash
y+4) -- (
\backslash
x+2.5+1/
\backslash
sqrt,
\backslash
y+4+1/
\backslash
sqrt) -- (
\backslash
x+2.5+5/
\backslash
sqrt,
\backslash
y+4-3/
\backslash
sqrt) -- (
\backslash
x+2.5+4/
\backslash
sqrt,
\backslash
y+4-4/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+2.5,
\backslash
y-4) -- (
\backslash
x+2.5+1/
\backslash
sqrt,
\backslash
y-4-1/
\backslash
sqrt) -- (
\backslash
x+2.5+5/
\backslash
sqrt,
\backslash
y-4+3/
\backslash
sqrt) -- (
\backslash
x+2.5+4/
\backslash
sqrt,
\backslash
y-4+4/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+0.25,
\backslash
y-1) -- (
\backslash
x+1.75,
\backslash
y-1) -- (
\backslash
x+2.5+3.75/
\backslash
sqrt,
\backslash
y-4+3.75/
\backslash
sqrt) -- (
\backslash
x+2.5+0.25/
\backslash
sqrt,
\backslash
y-4+0.25/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+0.25,
\backslash
y+1) -- (
\backslash
x+1.75,
\backslash
y+1) -- (
\backslash
x+2.5+3.75/
\backslash
sqrt,
\backslash
y+4-3.75/
\backslash
sqrt) -- (
\backslash
x+2.5+0.25/
\backslash
sqrt,
\backslash
y+4-0.25/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+2.5+3.75/
\backslash
sqrt,
\backslash
y-4+3.75/
\backslash
sqrt) -- (
\backslash
x+2.5+0.25/
\backslash
sqrt,
\backslash
y-4+0.25/
\backslash
sqrt) -- (
\backslash
x+2.5+0.25/
\backslash
sqrt,
\backslash
y+4-0.25/
\backslash
sqrt) -- (
\backslash
x+2.5+3.75/
\backslash
sqrt,
\backslash
y+4-3.75/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+1,
\backslash
y-1) -- (
\backslash
x+2.5+1/
\backslash
sqrt,
\backslash
y-4+1/
\backslash
sqrt) -- (
\backslash
x+2.5+1.5/
\backslash
sqrt,
\backslash
y+4-1.5/
\backslash
sqrt) -- (
\backslash
x+2.5+2/
\backslash
sqrt,
\backslash
y-4+2/
\backslash
sqrt) -- (
\backslash
x+2.5+2/
\backslash
sqrt,
\backslash
y+4-2/
\backslash
sqrt) -- (
\backslash
x+2.5+1.5/
\backslash
sqrt,
\backslash
y-4+1.5/
\backslash
sqrt) -- (
\backslash
x+2.5+1/
\backslash
sqrt,
\backslash
y+4-1/
\backslash
sqrt) -- (
\backslash
x+1,
\backslash
y+1);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+1,
\backslash
y+0.5) {$S^0$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+1,
\backslash
y-0.5) {$S^3$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+2.5+2.5/
\backslash
sqrt,
\backslash
y+4-1.5/
\backslash
sqrt) {$S^1$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+2.5+2.5/
\backslash
sqrt,
\backslash
y-4+1.5/
\backslash
sqrt) {$S^2$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
x{19}
\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
y{-3}
\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
sqrt{1.41421356237}
\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+1,
\backslash
y-1) -| (
\backslash
x+2,
\backslash
y+1) -| cycle
\end_layout

\begin_layout Plain Layout

      (
\backslash
x+1,
\backslash
y) -- (
\backslash
x+2,
\backslash
y);
\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+3,
\backslash
y+3) -- (
\backslash
x+3+1/
\backslash
sqrt,
\backslash
y+3+1/
\backslash
sqrt) -- (
\backslash
x+3+3/
\backslash
sqrt,
\backslash
y+3-1/
\backslash
sqrt) -- (
\backslash
x+3+2/
\backslash
sqrt,
\backslash
y+3-2/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
draw (
\backslash
x+3,
\backslash
y-3) -- (
\backslash
x+3+1/
\backslash
sqrt,
\backslash
y-3-1/
\backslash
sqrt) -- (
\backslash
x+3+3/
\backslash
sqrt,
\backslash
y-3+1/
\backslash
sqrt) -- (
\backslash
x+3+2/
\backslash
sqrt,
\backslash
y-3+2/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+1.25,
\backslash
y-1) -- (
\backslash
x+1.75,
\backslash
y-1) -- (
\backslash
x+3+1.75/
\backslash
sqrt,
\backslash
y-3+1.75/
\backslash
sqrt) -- (
\backslash
x+3+0.25/
\backslash
sqrt,
\backslash
y-3+0.25/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+1.25,
\backslash
y+1) -- (
\backslash
x+1.75,
\backslash
y+1) -- (
\backslash
x+3+1.75/
\backslash
sqrt,
\backslash
y+3-1.75/
\backslash
sqrt) -- (
\backslash
x+3+0.25/
\backslash
sqrt,
\backslash
y+3-0.25/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
fill [opacity=0.15] (
\backslash
x+3+1.75/
\backslash
sqrt,
\backslash
y-3+1.75/
\backslash
sqrt) -- (
\backslash
x+3+0.25/
\backslash
sqrt,
\backslash
y-3+0.25/
\backslash
sqrt) -- (
\backslash
x+3+0.25/
\backslash
sqrt,
\backslash
y+3-0.25/
\backslash
sqrt) -- (
\backslash
x+3+1.75/
\backslash
sqrt,
\backslash
y+3-1.75/
\backslash
sqrt) -- cycle;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+1.5,
\backslash
y+0.5) {$S^0$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+1.5,
\backslash
y-0.5) {$S^3$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+3+1.5/
\backslash
sqrt,
\backslash
y+3-0.5/
\backslash
sqrt) {$S^1$};
\end_layout

\begin_layout Plain Layout


\backslash
node at (
\backslash
x+3+1.5/
\backslash
sqrt,
\backslash
y-3+0.5/
\backslash
sqrt) {$S^2$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node [font=
\backslash
Huge] at (11,-3) {$
\backslash
rightsquigarrow$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:cluster-paths"

\end_inset

From super-regular pairs to cluster-cycles.
 An example special path is shown, for 
\begin_inset Formula $k=7$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Concluding Remarks
\end_layout

\begin_layout Standard
We have proved that any given bounded-degree spanning tree typically appears
 when a linear number of random edges are added to a dense graph.
 There are a few interesting questions that remain open.
 Most prominent is the question of embedding more general kinds of spanning
 subgraphs into randomly perturbed graphs.
 It would be particularly interesting if the general result of 
\begin_inset CommandInset citation
LatexCommand cite
key "BST09"

\end_inset

 (concerning arbitrary spanning graphs with bounded degree and low bandwidth)
 could be adapted to this setting.
 It is also possible that our use of Szemer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

edi's regularity lemma could be avoided, thus drastically improving the
 constants 
\begin_inset Formula $\c\left(\a\right)$
\end_inset

 and perhaps allowing us to say something about random perturbations of
 graphs which have slightly sublinear minimum degree.
\end_layout

\begin_layout Standard
\noindent

\series bold
Acknowledgement.

\series default
 Parts of this work were carried out when the first author visited the Institute
 for Mathematical Research (FIM) of ETH Zurich, and also when the third
 author visited the School of Mathematical Sciences of Tel Aviv University,
 Israel.
 We would like to thank both institutions for their hospitality and for
 creating a stimulating research environment.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "references"
options "amsplain_initials"

\end_inset


\end_layout

\end_body
\end_document
